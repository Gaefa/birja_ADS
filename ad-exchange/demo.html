<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ë–∏—Ä–∂–∞ –†–µ–∫–ª–∞–º—ã ‚Äî Demo v2</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#f4f5f7;color:#1a1a2e;min-height:100vh}
.nav{background:#fff;border-bottom:1px solid #e8e8f0;padding:0 32px;height:60px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:100;box-shadow:0 1px 4px rgba(0,0,0,.06)}
.logo{display:flex;align-items:center;gap:10px;font-weight:800;font-size:18px;color:#1a1a2e;cursor:pointer}
.logo-icon{width:34px;height:34px;background:linear-gradient(135deg,#6366f1,#8b5cf6);border-radius:9px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:13px;font-weight:800}
.nav-right{display:flex;align-items:center;gap:10px}
.nav-user{font-size:13px;color:#666;background:#f4f5f7;padding:6px 14px;border-radius:20px}
.btn{padding:8px 18px;border-radius:8px;border:none;cursor:pointer;font-size:14px;font-weight:600;transition:.15s}
.btn-primary{background:#6366f1;color:#fff}.btn-primary:hover{background:#5558e8}
.btn-secondary{background:#f4f5f7;color:#444;border:1px solid #e0e0e8}.btn-secondary:hover{background:#eaeaf4}
.btn-success{background:#dcfce7;color:#16a34a;border:none}.btn-success:hover{background:#bbf7d0}
.btn-danger{background:#fee2e2;color:#dc2626;border:none}.btn-danger:hover{background:#fecaca}
.btn-warning{background:#fef3c7;color:#d97706;border:none}.btn-warning:hover{background:#fde68a}
.btn-sm{padding:5px 12px;font-size:12px;border-radius:6px}
.btn:disabled{opacity:.45;cursor:not-allowed}
.page{display:none}.page.active{display:block;animation:fi .2s ease}
@keyframes fi{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}
.hero{background:linear-gradient(135deg,#6366f1 0%,#8b5cf6 50%,#a855f7 100%);color:#fff;padding:80px 32px;text-align:center}
.hero h1{font-size:48px;font-weight:900;margin-bottom:16px;letter-spacing:-1px}
.hero p{font-size:20px;opacity:.85;max-width:560px;margin:0 auto 36px;line-height:1.6}
.hero-btns{display:flex;gap:14px;justify-content:center;flex-wrap:wrap}
.btn-hw{background:#fff;color:#6366f1;padding:14px 32px;border-radius:12px;font-size:16px;font-weight:700;border:none;cursor:pointer;transition:.15s}
.btn-hw:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,.15)}
.btn-ho{background:transparent;color:#fff;padding:14px 32px;border-radius:12px;font-size:16px;font-weight:700;border:2px solid rgba(255,255,255,.6);cursor:pointer;transition:.15s}
.btn-ho:hover{background:rgba(255,255,255,.1)}
.features{max-width:1100px;margin:0 auto;padding:64px 32px}
.features h2{text-align:center;font-size:28px;font-weight:800;margin-bottom:32px}
.features-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:24px}
.fc{background:#fff;border-radius:16px;padding:28px;box-shadow:0 2px 12px rgba(0,0,0,.06);transition:.2s}
.fc:hover{transform:translateY(-3px);box-shadow:0 8px 24px rgba(0,0,0,.1)}
.fc-icon{width:52px;height:52px;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:24px;margin-bottom:16px}
.fc h3{font-size:17px;font-weight:700;margin-bottom:8px}.fc p{font-size:14px;color:#666;line-height:1.6}
.stats-row{display:flex;justify-content:center;gap:60px;padding:48px 32px;background:#fff;border-top:1px solid #f0f0f8}
.sr-item{text-align:center}
.sr-num{font-size:36px;font-weight:900;background:linear-gradient(135deg,#6366f1,#a855f7);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.sr-lbl{font-size:13px;color:#888;margin-top:4px}
.app-layout{display:flex;min-height:calc(100vh - 60px)}
.sidebar{width:220px;background:#fff;border-right:1px solid #e8e8f0;padding:20px 12px;flex-shrink:0}
.ss{font-size:11px;font-weight:700;color:#aaa;text-transform:uppercase;letter-spacing:.8px;padding:0 10px;margin:16px 0 6px}
.si{display:flex;align-items:center;gap:10px;padding:9px 10px;border-radius:8px;cursor:pointer;font-size:14px;color:#555;transition:.12s;margin-bottom:2px}
.si:hover{background:#f4f5f7;color:#333}.si.active{background:#eef2ff;color:#6366f1;font-weight:600}
.main{flex:1;padding:28px 32px;overflow-y:auto}
.ph{margin-bottom:24px}.ph h1{font-size:24px;font-weight:800}.ph p{font-size:14px;color:#888;margin-top:4px}
.ph-row{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;flex-wrap:wrap;margin-bottom:24px}
.sc-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:24px}
.sc{background:#fff;border-radius:12px;padding:20px;box-shadow:0 1px 6px rgba(0,0,0,.06)}
.sc .v{font-size:28px;font-weight:800;margin-bottom:4px}.sc .l{font-size:13px;color:#888}
.sc.c1 .v{color:#6366f1}.sc.c2 .v{color:#16a34a}.sc.c3 .v{color:#7c3aed}.sc.c4 .v{color:#d97706}
.sc[onclick]{transition:transform .15s,box-shadow .15s}.sc[onclick]:hover{transform:translateY(-3px);box-shadow:0 6px 20px rgba(0,0,0,.12)}
.sc-btn{border:none;text-align:left;font-family:inherit;width:100%;cursor:pointer;pointer-events:all;transition:transform .15s,box-shadow .15s}.sc-btn:hover{transform:translateY(-3px);box-shadow:0 6px 20px rgba(0,0,0,.12)}
.card{background:#fff;border-radius:14px;padding:22px;box-shadow:0 1px 6px rgba(0,0,0,.06);margin-bottom:20px}
.ct{font-size:16px;font-weight:700;margin-bottom:16px;display:flex;align-items:center;gap:8px}
.g2{display:grid;grid-template-columns:1fr 1fr;gap:20px}
.g3{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
.b{display:inline-flex;align-items:center;padding:3px 10px;border-radius:20px;font-size:12px;font-weight:600}
.b.g{background:#dcfce7;color:#16a34a}.b.y{background:#fef9c3;color:#854d0e}
.b.bl{background:#dbeafe;color:#1d4ed8}.b.pu{background:#f3e8ff;color:#7c3aed}
.b.r{background:#fee2e2;color:#dc2626}.b.gr{background:#f4f5f7;color:#555}.b.in{background:#eef2ff;color:#6366f1}
.bc{background:#fff;border-radius:14px;padding:20px;box-shadow:0 1px 8px rgba(0,0,0,.07);transition:.2s;cursor:pointer;border:2px solid transparent}
.bc:hover{border-color:#6366f1;transform:translateY(-2px);box-shadow:0 6px 20px rgba(99,102,241,.12)}
.bc-av{width:48px;height:48px;border-radius:12px;background:linear-gradient(135deg,#6366f1,#a855f7);display:flex;align-items:center;justify-content:center;color:#fff;font-size:18px;font-weight:700;margin-bottom:12px}
.cc{background:#fff;border-radius:12px;padding:18px;box-shadow:0 1px 6px rgba(0,0,0,.06);margin-bottom:14px;border-left:4px solid #6366f1}
.cc-title{font-size:15px;font-weight:700;margin-bottom:6px}
.cc-desc{font-size:13px;color:#666;margin-bottom:10px;line-height:1.5}
.pli{display:flex;align-items:center;justify-content:space-between;padding:12px;background:#f9f9fc;border-radius:8px;margin-bottom:8px}
.pli-n{font-size:14px;font-weight:600}.pli-d{font-size:12px;color:#888;margin-top:1px}.pli-p{font-size:16px;font-weight:800;color:#6366f1}
.soc{display:flex;align-items:center;gap:12px;padding:12px;background:#f9f9fc;border-radius:8px;margin-bottom:8px}
.soc-icon{width:36px;height:36px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:18px;background:#eef2ff;flex-shrink:0}
.vb{background:#fef9c3;border:1px solid #fde68a;border-radius:12px;padding:14px 18px;display:flex;align-items:center;gap:12px;margin-bottom:20px}
.vb-icon{font-size:24px}.vb h4{font-size:14px;font-weight:700;color:#854d0e;margin-bottom:2px}.vb p{font-size:13px;color:#92400e}
.vb-danger{background:#fee2e2;border-color:#fca5a5}
.vb-danger h4{color:#dc2626}.vb-danger p{color:#991b1b}
.tbl{width:100%;border-collapse:collapse}
.tbl th{font-size:12px;font-weight:700;color:#888;text-transform:uppercase;letter-spacing:.5px;padding:10px 12px;text-align:left;border-bottom:1px solid #f0f0f8}
.tbl td{padding:12px;font-size:14px;border-bottom:1px solid #f4f5f7;vertical-align:middle}
.tbl tr:last-child td{border-bottom:none}.tbl tr:hover td{background:#fafafa}
.tbl-clickable tr:not(:first-child){cursor:pointer}
.fg{margin-bottom:16px}.fl{display:block;font-size:13px;font-weight:600;color:#444;margin-bottom:6px}
.fi{width:100%;padding:10px 14px;border:1.5px solid #e0e0e8;border-radius:8px;font-size:14px;transition:.12s;outline:none;background:#fff}
.fi:focus{border-color:#6366f1;box-shadow:0 0 0 3px rgba(99,102,241,.1)}
.fr{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.tabs{display:flex;border-bottom:2px solid #f0f0f8;margin-bottom:20px}
.tab{padding:10px 18px;cursor:pointer;font-size:14px;font-weight:600;color:#888;border-bottom:2px solid transparent;margin-bottom:-2px;transition:.12s}
.tab.active{color:#6366f1;border-bottom-color:#6366f1}
.tc{display:none}.tc.active{display:block}
.login-wrap{min-height:calc(100vh - 60px);display:flex;align-items:center;justify-content:center;padding:32px}
.lc{background:#fff;border-radius:20px;padding:40px;width:100%;max-width:420px;box-shadow:0 8px 40px rgba(0,0,0,.1)}
.lc h2{font-size:24px;font-weight:800;margin-bottom:6px}.lc>p{font-size:14px;color:#888;margin-bottom:28px}
.ql{display:flex;flex-direction:column;gap:8px;margin-top:20px;padding-top:20px;border-top:1px solid #f0f0f8}
.ql-lbl{font-size:12px;font-weight:700;color:#aaa;text-transform:uppercase;letter-spacing:.5px;margin-bottom:4px}
.qb{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;border:1.5px solid #e8e8f0;border-radius:8px;cursor:pointer;background:#fff;transition:.12s;font-size:13px}
.qb:hover{border-color:#6366f1;background:#fafbff}
.qb-email{font-weight:600;color:#1a1a2e}.qb-sub{font-size:12px;color:#888}
.qb-role{font-size:11px;color:#fff;padding:2px 8px;border-radius:10px;font-weight:700}
.qb-role.issuer{background:#6366f1}.qb-role.blogger{background:#a855f7}.qb-role.admin{background:#dc2626}
.mo{position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:200;display:none;align-items:center;justify-content:center;padding:20px}
.mo.open{display:flex}
.modal{background:#fff;border-radius:20px;padding:32px;width:100%;max-width:580px;max-height:90vh;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,.2)}
.modal-wide{max-width:780px}
.mh{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:20px}
.mc{background:none;border:none;font-size:24px;cursor:pointer;color:#aaa;line-height:1}.mc:hover{color:#333}
.es{text-align:center;padding:40px;color:#aaa;font-size:14px}
.es-icon{font-size:40px;margin-bottom:12px}
.pl{padding:4px 8px;background:#f4f5f7;border-radius:6px;font-size:11px;font-weight:600;color:#555;display:inline-block;margin:2px}
.sh{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px}
.st{font-size:15px;font-weight:700}
.profile-header{display:flex;align-items:center;gap:20px;padding:24px;background:#fff;border-radius:14px;box-shadow:0 1px 6px rgba(0,0,0,.06);margin-bottom:20px}
.pa{width:72px;height:72px;border-radius:16px;background:linear-gradient(135deg,#6366f1,#a855f7);display:flex;align-items:center;justify-content:center;color:#fff;font-size:28px;font-weight:700;flex-shrink:0}
.pn{font-size:22px;font-weight:800;margin-bottom:4px}.ps{font-size:14px;color:#888}
.pb{display:flex;gap:8px;margin-top:8px;flex-wrap:wrap}
.sub-card{background:#fff;border-radius:14px;padding:24px;box-shadow:0 1px 6px rgba(0,0,0,.06);border:2px solid #e8e8f0}
.sub-card.current{border-color:#6366f1}.sub-card.pro{border-color:#a855f7}
.sub-price{font-size:28px;font-weight:900;margin:12px 0 16px}
.sub-features{font-size:13px;color:#555;line-height:2}
/* FILTER BAR */
.filter-bar{display:flex;align-items:center;gap:10px;flex-wrap:wrap;margin-bottom:20px;background:#fff;padding:14px 18px;border-radius:12px;box-shadow:0 1px 4px rgba(0,0,0,.05)}
.filter-bar label{font-size:12px;font-weight:700;color:#888}
.fi-sm{padding:6px 10px;border:1.5px solid #e0e0e8;border-radius:8px;font-size:13px;outline:none;background:#fff;min-width:120px}
.fi-sm:focus{border-color:#6366f1}
/* TAGS */
.tags-wrap{display:flex;flex-wrap:wrap;gap:6px;margin-top:8px}
.tag{padding:5px 12px;border-radius:20px;font-size:12px;font-weight:600;cursor:pointer;border:1.5px solid #e0e0e8;color:#555;background:#fff;transition:.12s}
.tag:hover{border-color:#6366f1;color:#6366f1}
.tag.active{background:#eef2ff;border-color:#6366f1;color:#6366f1}
/* CHAT */
.chat-wrap{border:1px solid #f0f0f8;border-radius:12px;overflow:hidden}
.chat-msgs{padding:16px;background:#fafafa;max-height:260px;overflow-y:auto;display:flex;flex-direction:column;gap:10px}
.chat-msg{max-width:75%;padding:10px 14px;border-radius:12px;font-size:13px;line-height:1.5}
.chat-msg.out{background:#6366f1;color:#fff;align-self:flex-end;border-bottom-right-radius:4px}
.chat-msg.in{background:#fff;border:1px solid #e8e8f0;align-self:flex-start;border-bottom-left-radius:4px}
.chat-msg .msg-time{font-size:10px;opacity:.65;margin-top:4px}
.chat-input-row{display:flex;gap:8px;padding:12px;border-top:1px solid #f0f0f8;background:#fff}
.chat-input{flex:1;padding:8px 12px;border:1.5px solid #e0e0e8;border-radius:8px;font-size:13px;outline:none}
.chat-input:focus{border-color:#6366f1}
/* DEAL CARD */
.deal-card{background:#fff;border-radius:12px;padding:18px;box-shadow:0 1px 6px rgba(0,0,0,.06);margin-bottom:14px;border-left:4px solid #7c3aed}
/* COMMISSION BOX */
.comm-box{background:linear-gradient(135deg,#f0f4ff,#f5f3ff);border:1px solid #e0e0f8;border-radius:10px;padding:14px;margin:14px 0}
.comm-row{display:flex;justify-content:space-between;padding:4px 0;font-size:13px}
.comm-row.total{border-top:1px solid #e0e0f8;margin-top:6px;padding-top:10px;font-weight:800;font-size:14px}
/* CHART */
.chart-box{background:#fff;border-radius:14px;padding:20px;box-shadow:0 1px 6px rgba(0,0,0,.06)}
.chart-title{font-size:14px;font-weight:700;margin-bottom:16px;color:#555}
/* USER CARD in admin */
.user-row{display:flex;align-items:center;gap:12px;padding:12px;border-radius:10px;cursor:pointer;transition:.12s;border-bottom:1px solid #f4f5f7}
.user-row:hover{background:#f9f9fc}
.user-ava{width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;font-size:14px;flex-shrink:0}
</style>
</head>
<body>

<!-- NAV -->
<nav class="nav">
  <div class="logo" onclick="showPage('landing')">
    <div class="logo-icon">–ë–†</div>
    –ë–∏—Ä–∂–∞ –†–µ–∫–ª–∞–º—ã
  </div>
  <div class="nav-right" id="navRight">
    <button class="btn btn-secondary btn-sm" onclick="showPage('login')">–í–æ–π—Ç–∏</button>
    <button class="btn btn-primary btn-sm" onclick="showPage('login')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
  </div>
</nav>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LANDING ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page active" id="page-landing">
  <div class="hero">
    <h1>–ë–∏—Ä–∂–∞ –†–µ–∫–ª–∞–º—ã</h1>
    <p>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π –∏ –∫—Ä–∏–ø—Ç–æ-–±–ª–æ–≥–µ—Ä–æ–≤. –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Å–¥–µ–ª–∫–∏ —á–µ—Ä–µ–∑ —ç—Å–∫—Ä–æ—É.</p>
    <div class="hero-btns">
      <button class="btn-hw" onclick="quickLogin('blogger')">–Ø –±–ª–æ–≥–µ—Ä ‚Üí</button>
      <button class="btn-ho" onclick="quickLogin('issuer')">–Ø —ç–º–∏—Ç–µ–Ω—Ç ‚Üí</button>
    </div>
  </div>
  <div class="features">
    <h2>–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</h2>
    <div class="features-grid">
      <div class="fc"><div class="fc-icon" style="background:#eef2ff">ü§ù</div><h3>–ü—Ä—è–º—ã–µ —Å–¥–µ–ª–∫–∏</h3><p>–≠–º–∏—Ç–µ–Ω—Ç –≤—ã–±–∏—Ä–∞–µ—Ç –±–ª–æ–≥–µ—Ä–∞ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞ –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —É—Å–ª–æ–≤–∏—è —Å–¥–µ–ª–∫–∏. –ë–ª–æ–≥–µ—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏–ª–∏ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç.</p></div>
      <div class="fc"><div class="fc-icon" style="background:#f5f3ff">üì¢</div><h3>–ö–∞–º–ø–∞–Ω–∏–∏</h3><p>–ó–∞–ø—É—Å–∫–∞–π—Ç–µ –∫–∞–º–ø–∞–Ω–∏–∏ –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–ª–æ–≥–µ—Ä–æ–≤ —Å—Ä–∞–∑—É. –ë–ª–æ–≥–µ—Ä—ã –æ—Ç–∫–ª–∏–∫–∞—é—Ç—Å—è, –≤—ã –≤—ã–±–∏—Ä–∞–µ—Ç–µ –ª—É—á—à–∏—Ö.</p></div>
      <div class="fc"><div class="fc-icon" style="background:#fdf2f8">üîí</div><h3>–≠—Å–∫—Ä–æ—É-–∑–∞—â–∏—Ç–∞</h3><p>–°—Ä–µ–¥—Å—Ç–≤–∞ –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞—é—Ç—Å—è –¥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è. –ö–æ–º–∏—Å—Å–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã +10% (–º–∏–Ω.) –∫ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∞–≤—Ç–æ—Ä–∞.</p></div>
    </div>
  </div>
  <div class="stats-row">
    <div class="sr-item"><div class="sr-num">500+</div><div class="sr-lbl">–ë–ª–æ–≥–µ—Ä–æ–≤</div></div>
    <div class="sr-item"><div class="sr-num">120+</div><div class="sr-lbl">–ö–æ–º–ø–∞–Ω–∏–π</div></div>
    <div class="sr-item"><div class="sr-num">‚ÇΩ18–ú+</div><div class="sr-lbl">–û–±—ä—ë–º —Å–¥–µ–ª–æ–∫</div></div>
    <div class="sr-item"><div class="sr-num">4.8‚òÖ</div><div class="sr-lbl">–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥</div></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LOGIN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page" id="page-login">
  <div class="login-wrap">
    <div class="lc">
      <h2>–í–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç</h2>
      <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –Ω–∞ –ë–∏—Ä–∂—É –†–µ–∫–ª–∞–º—ã</p>
      <div class="fg"><label class="fl">Email</label><input class="fi" id="loginEmail" type="email" placeholder="you@example.com"></div>
      <div class="fg"><label class="fl">–ü–∞—Ä–æ–ª—å</label><input class="fi" id="loginPassword" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"></div>
      <button class="btn btn-primary" style="width:100%;padding:12px" onclick="doLogin()">–í–æ–π—Ç–∏</button>
      <div class="ql">
        <div class="ql-lbl">–ë—ã—Å—Ç—Ä—ã–π –≤—Ö–æ–¥</div>
        <div class="qb" onclick="quickLogin('issuer')"><div><div class="qb-email">issuer1@test.ru</div><div class="qb-sub">BingX Exchange ¬∑ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω</div></div><span class="qb-role issuer">–≠–ú–ò–¢–ï–ù–¢</span></div>
        <div class="qb" onclick="quickLogin('issuer2')"><div><div class="qb-email">issuer2@test.ru</div><div class="qb-sub">InvestFund Alpha ¬∑ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</div></div><span class="qb-role issuer">–≠–ú–ò–¢–ï–ù–¢</span></div>
        <div class="qb" onclick="quickLogin('blogger')"><div><div class="qb-email">blogger1@test.ru</div><div class="qb-sub">–ö—Ä–∏–ø—Ç–æ –ë–ª–æ–≥–µ—Ä ¬∑ 15K TG, 25K YT</div></div><span class="qb-role blogger">–ë–õ–û–ì–ï–†</span></div>
        <div class="qb" onclick="quickLogin('admin')"><div><div class="qb-email">admin@adexchange.ru</div><div class="qb-sub">–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</div></div><span class="qb-role admin">ADMIN</span></div>
      </div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ISSUER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page" id="page-issuer">
  <div class="app-layout">
    <div class="sidebar">
      <div class="ss">–ú–µ–Ω—é</div>
      <div class="si active" onclick="iTab('dashboard',this)"><span>üè†</span> –î–∞—à–±–æ—Ä–¥</div>
      <div class="si" onclick="iTab('catalog',this)"><span>üë•</span> –ö–∞—Ç–∞–ª–æ–≥ –±–ª–æ–≥–µ—Ä–æ–≤</div>
      <div class="si" onclick="iTab('campaigns',this)"><span>üì¢</span> –ö–∞–º–ø–∞–Ω–∏–∏</div>
      <div class="si" onclick="iTab('deals',this)"><span>ü§ù</span> –°–¥–µ–ª–∫–∏</div>
      <div class="ss">–ü—Ä–æ—Ñ–∏–ª—å</div>
      <div class="si" onclick="iTab('profile',this)"><span>üè¢</span> –ö–æ–º–ø–∞–Ω–∏—è</div>
      <div class="si" onclick="iTab('sub',this)"><span>üíé</span> –ü–æ–¥–ø–∏—Å–∫–∞</div>
    </div>
    <div class="main">

      <!-- i-dashboard -->
      <div class="tc active" id="i-dashboard">
        <div id="issuerBanner" class="vb" style="display:none">
          <div class="vb-icon">‚è≥</div>
          <div style="flex:1"><h4>–ê–∫–∫–∞—É–Ω—Ç –Ω–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏</h4><p>–ù–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ. –û–±—ã—á–Ω–æ 1‚Äì2 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è. –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–π –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ.</p></div>
        </div>
        <div class="ph-row">
          <div class="ph"><h1 id="iTitle">–ü–∞–Ω–µ–ª—å —ç–º–∏—Ç–µ–Ω—Ç–∞</h1><p id="iSub">BingX Exchange</p></div>
          <button class="btn btn-primary" id="btnNewCampaign" onclick="tryCreateCampaign()">+ –ù–æ–≤–∞—è –∫–∞–º–ø–∞–Ω–∏—è</button>
        </div>
        <div class="sc-grid">
          <div class="sc c1"><div class="v" id="iStatCamp">0</div><div class="l">–ê–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π</div></div>
          <div class="sc c2"><div class="v" id="iStatBudget">‚ÇΩ0</div><div class="l">–ë—é–¥–∂–µ—Ç –∫–∞–º–ø–∞–Ω–∏–π</div></div>
          <div class="sc c3"><div class="v" id="iStatTier">BASE</div><div class="l">–ü–æ–¥–ø–∏—Å–∫–∞</div></div>
          <div class="sc c4"><div class="v" id="iStatStatus">‚úì</div><div class="l">–°—Ç–∞—Ç—É—Å</div></div>
        </div>
        <div class="g2">
          <div class="card">
            <div class="ct">üì¢ –ú–æ–∏ –∫–∞–º–ø–∞–Ω–∏–∏</div>
            <div id="iDashCampaigns"></div>
          </div>
          <div class="card">
            <div class="ct">ü§ù –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–¥–µ–ª–∫–∏</div>
            <div id="iDashDeals"></div>
          </div>
        </div>
      </div>

      <!-- i-catalog -->
      <div class="tc" id="i-catalog">
        <div class="ph-row">
          <div class="ph"><h1>–ö–∞—Ç–∞–ª–æ–≥ –±–ª–æ–≥–µ—Ä–æ–≤</h1><p>–ù–∞–π–¥–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –∞–≤—Ç–æ—Ä–æ–≤ –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è</p></div>
        </div>
        <div class="filter-bar">
          <label>–ù–∏—à–∞:</label>
          <select class="fi-sm" id="catFilterNiche" onchange="renderCatalog()">
            <option value="">–í—Å–µ</option>
            <option value="–∫—Ä–∏–ø—Ç–æ">–ö—Ä–∏–ø—Ç–æ</option>
            <option value="–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏">–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏</option>
            <option value="DeFi">DeFi / Web3</option>
          </select>
          <label>–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å:</label>
          <select class="fi-sm" id="catSort" onchange="renderCatalog()">
            <option value="rating">–ü–æ —Ä–µ–π—Ç–∏–Ω–≥—É</option>
            <option value="price_asc">–¶–µ–Ω–∞: —Å–Ω–∞—á–∞–ª–∞ –¥–µ—à–µ–≤–ª–µ</option>
            <option value="price_desc">–¶–µ–Ω–∞: —Å–Ω–∞—á–∞–ª–∞ –¥–æ—Ä–æ–∂–µ</option>
            <option value="subs">–ü–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º</option>
          </select>
          <label>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:</label>
          <select class="fi-sm" id="catFilterPlat" onchange="renderCatalog()">
            <option value="">–í—Å–µ</option>
            <option value="Telegram">Telegram</option>
            <option value="YouTube">YouTube</option>
            <option value="VK">VK</option>
            <option value="–Ø–Ω–¥–µ–∫—Å.–î–∑–µ–Ω">–Ø–Ω–¥–µ–∫—Å.–î–∑–µ–Ω</option>
            <option value="Instagram">Instagram</option>
          </select>
        </div>
        <div class="g3" id="catalogGrid"></div>
        <div id="catalogEmpty" class="es" style="display:none"><div class="es-icon">üîç</div>–ù–µ—Ç –±–ª–æ–≥–µ—Ä–æ–≤ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–∞–º</div>
      </div>

      <!-- i-campaigns -->
      <div class="tc" id="i-campaigns">
        <div class="ph-row">
          <div class="ph"><h1>–ú–æ–∏ –∫–∞–º–ø–∞–Ω–∏–∏</h1></div>
          <button class="btn btn-primary" onclick="tryCreateCampaign()">+ –ù–æ–≤–∞—è –∫–∞–º–ø–∞–Ω–∏—è</button>
        </div>
        <div id="iCampaignsList"></div>
      </div>

      <!-- i-deals -->
      <div class="tc" id="i-deals">
        <div class="ph"><h1>–°–¥–µ–ª–∫–∏</h1><p>–ò—Å—Ç–æ—Ä–∏—è –∏ —Å—Ç–∞—Ç—É—Å –≤–∞—à–∏—Ö —Å–¥–µ–ª–æ–∫</p></div>
        <div id="iDealsList"></div>
      </div>

      <!-- i-profile -->
      <div class="tc" id="i-profile">
        <div class="ph"><h1>–ü—Ä–æ—Ñ–∏–ª—å –∫–æ–º–ø–∞–Ω–∏–∏</h1></div>
        <div class="card" id="iProfileCard"></div>
      </div>

      <!-- i-sub -->
      <div class="tc" id="i-sub">
        <div class="ph"><h1>–ü–æ–¥–ø–∏—Å–∫–∞</h1></div>
        <div class="g2">
          <div class="sub-card current" id="subBase">
            <div style="display:flex;align-items:center;justify-content:space-between"><b style="font-size:16px">üîµ BASE</b><span class="b in" id="subBaseBadge">–¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω</span></div>
            <div class="sub-price">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</div>
            <div class="sub-features">‚úì –î–æ—Å—Ç—É–ø –∫ –∫–∞—Ç–∞–ª–æ–≥—É –±–ª–æ–≥–µ—Ä–æ–≤<br>‚úì –î–æ 5 –∫–∞–º–ø–∞–Ω–∏–π –≤ –º–µ—Å—è—Ü<br>‚úì –ü—Ä—è–º—ã–µ —Å–¥–µ–ª–∫–∏<br><span style="color:#aaa">‚úó –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏<br>‚úó –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞</span></div>
          </div>
          <div class="sub-card pro" id="subPro">
            <div style="display:flex;align-items:center;justify-content:space-between"><b style="font-size:16px">üíé PRO</b><span class="b pu" id="subProBadge">–ê–ø–≥—Ä–µ–π–¥</span></div>
            <div class="sub-price">‚ÇΩ15 000 <span style="font-size:14px;font-weight:400;color:#888">/ –º–µ—Å</span></div>
            <div class="sub-features">‚úì –í—Å—ë –∏–∑ BASE<br>‚úì –ë–µ–∑–ª–∏–º–∏—Ç –∫–∞–º–ø–∞–Ω–∏–π<br>‚úì –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏ üîí<br>‚úì –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –±–ª–æ–≥–µ—Ä–æ–≤<br>‚úì –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</div>
            <button class="btn btn-primary" style="width:100%;margin-top:16px" id="btnSubPro" onclick="activatePro()">–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ PRO ‚Äî ‚ÇΩ15 000/–º–µ—Å</button>
          </div>
        </div>
        <div style="margin-top:16px;padding:14px 18px;background:#fff;border-radius:12px;box-shadow:0 1px 6px rgba(0,0,0,.06);font-size:13px;color:#888">
          üí≥ –û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ Stripe / –ÆKassa. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–ª–∞—Ç—ë–∂–Ω–æ–≥–æ —à–ª—é–∑–∞ ‚Äî –≤ production-–≤–µ—Ä—Å–∏–∏.
        </div>
      </div>

    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê BLOGGER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page" id="page-blogger">
  <div class="app-layout">
    <div class="sidebar">
      <div class="ss">–ú–µ–Ω—é</div>
      <div class="si active" onclick="bTab('dashboard',this)"><span>üè†</span> –î–∞—à–±–æ—Ä–¥</div>
      <div class="si" onclick="bTab('profile',this)"><span>üë§</span> –ü—Ä–æ—Ñ–∏–ª—å</div>
      <div class="si" onclick="bTab('campaigns',this)"><span>üì¢</span> –ö–∞–º–ø–∞–Ω–∏–∏</div>
      <div class="si" onclick="bTab('deals',this)"><span>ü§ù</span> –°–¥–µ–ª–∫–∏</div>
    </div>
    <div class="main">

      <!-- b-dashboard -->
      <div class="tc active" id="b-dashboard">
        <div class="ph"><h1 id="bTitle">–ü–∞–Ω–µ–ª—å –±–ª–æ–≥–µ—Ä–∞</h1><p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</p></div>
        <div class="sc-grid">
          <div class="sc c2" onclick="bTab('deals',document.querySelectorAll('#page-blogger .si')[3])" style="cursor:pointer" title="–û—Ç–∫—Ä—ã—Ç—å —Å–¥–µ–ª–∫–∏"><div class="v">1</div><div class="l">–ê–∫—Ç–∏–≤–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ ‚Üó</div></div>
          <div class="sc c1" onclick="openModal('mEarnings')" style="cursor:pointer" title="–ò—Å—Ç–æ—Ä–∏—è –∑–∞—Ä–∞–±–æ—Ç–∫–∞"><div class="v">‚ÇΩ30 000</div><div class="l">–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ ‚Üó</div></div>
          <div class="sc c4"><div class="v" id="bRating">‚òÖ 4.3</div><div class="l">–†–µ–π—Ç–∏–Ω–≥</div></div>
          <div class="sc c3" onclick="openModal('mCompletedDeals')" style="cursor:pointer" title="–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ —Å–¥–µ–ª–∫–∏"><div class="v">3</div><div class="l">–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö ‚Üó</div></div>
        </div>
        <div class="g2">
          <div class="card">
            <div class="ct">üì¢ –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏</div>
            <div class="cc">
              <div class="cc-title">BingX ‚Äî –û—Å–µ–Ω–Ω–∏–π –Ω–∞–±–æ—Ä –±–ª–æ–≥–µ—Ä–æ–≤</div>
              <div class="cc-desc">–ò—â–µ–º 10 –∫—Ä–∏–ø—Ç–æ-–±–ª–æ–≥–µ—Ä–æ–≤. BingX Exchange.</div>
              <div style="display:flex;align-items:center;justify-content:space-between"><span class="b in">‚ÇΩ25 000</span><button class="btn btn-primary btn-sm" onclick="bTab('campaigns', document.querySelector('#page-blogger .si:nth-child(4)'))">–°–º–æ—Ç—Ä–µ—Ç—å ‚Üí</button></div>
            </div>
          </div>
          <div class="card">
            <div class="ct">üîî –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –æ—Ç —ç–º–∏—Ç–µ–Ω—Ç–æ–≤</div>
            <div class="deal-card">
              <div style="display:flex;justify-content:space-between;align-items:flex-start">
                <div><div style="font-size:14px;font-weight:700">BingX Exchange</div><div style="font-size:12px;color:#888;margin-top:2px">–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∏ ¬∑ Telegram –ø–æ—Å—Ç</div></div>
                <span class="b y">–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏</span>
              </div>
              <div style="font-size:13px;color:#666;margin:8px 0">–†–µ–∫–ª–∞–º–Ω—ã–π –ø–æ—Å—Ç –æ BingX –≤ TG. –¢–ó –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–æ.</div>
              <div style="display:flex;gap:8px">
                <button class="btn btn-success btn-sm" onclick="showToast('‚úì –°–¥–µ–ª–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞!')">–ü—Ä–∏–Ω—è—Ç—å</button>
                <button class="btn btn-secondary btn-sm" onclick="bTab('deals', document.querySelector('#page-blogger .si:nth-child(5)'))">–û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç ‚Üí</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- b-profile -->
      <div class="tc" id="b-profile">
        <div class="ph"><h1>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h1></div>
        <div class="profile-header">
          <div style="position:relative;cursor:pointer" onclick="document.getElementById('bAvatarInput').click()" title="–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ">
            <div class="pa" id="bAvatar">–ö</div>
            <div style="position:absolute;bottom:-4px;right:-4px;width:22px;height:22px;background:#6366f1;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-size:12px;border:2px solid #fff">‚úèÔ∏è</div>
          </div>
          <input type="file" id="bAvatarInput" accept="image/*" style="display:none" onchange="previewBloggerAvatar(this)">
          <div>
            <div class="pn" id="bName">–ö—Ä–∏–ø—Ç–æ –ë–ª–æ–≥–µ—Ä 1</div>
            <div class="ps" id="bNicheGeo">–∫—Ä–∏–ø—Ç–æ ¬∑ –†–æ—Å—Å–∏—è ¬∑ @cryptoblogger1</div>
            <div class="pb"><span class="b g">‚úì –ê–∫—Ç–∏–≤–µ–Ω</span><span class="b in" id="bRatingBadge">‚òÖ 4.3</span><span class="b gr">3 —Å–¥–µ–ª–∫–∏</span></div>
          </div>
        </div>
        <div class="tabs">
          <div class="tab active" onclick="pTab('basic',this)">–û—Å–Ω–æ–≤–Ω–æ–µ</div>
          <div class="tab" onclick="pTab('socials',this)">–°–æ—Ü—Å–µ—Ç–∏</div>
          <div class="tab" onclick="pTab('prices',this)">–ü—Ä–∞–π—Å-–ª–∏—Å—Ç</div>
        </div>
        <div class="tc active" id="pt-basic">
          <div class="card">
            <div class="fr"><div class="fg"><label class="fl">–û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è</label><input class="fi" id="bInputName" value="–ö—Ä–∏–ø—Ç–æ –ë–ª–æ–≥–µ—Ä 1"></div><div class="fg"><label class="fl">Telegram</label><input class="fi" value="@cryptoblogger1"></div></div>
            <div class="fr"><div class="fg"><label class="fl">–ù–∏—à–∞</label><input class="fi" id="bInputNiche" value="–∫—Ä–∏–ø—Ç–æ, –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏, DeFi"></div><div class="fg"><label class="fl">–ì–µ–æ</label><input class="fi" value="–†–æ—Å—Å–∏—è, –°–ù–ì"></div></div>
            <div class="fg"><label class="fl">–û —Å–µ–±–µ</label><textarea class="fi" rows="3">–ü–∏—à—É –ø—Ä–æ –∫—Ä–∏–ø—Ç—É –∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ —É–∂–µ 3 –≥–æ–¥–∞. –ê—É–¥–∏—Ç–æ—Ä–∏—è: 18-35 –ª–µ—Ç, –†–§/–°–ù–ì. –°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: –æ–±–∑–æ—Ä—ã –±–∏—Ä–∂, DeFi –ø—Ä–æ—Ç–æ–∫–æ–ª—ã, —Ç—Ä–µ–π–¥–∏–Ω–≥.</textarea></div>
            <div class="fg">
              <label class="fl">–¢–µ–≥–∏ –ø—Ä–æ—Ñ–∏–ª—è (–æ —á—ë–º –ø–∏—à—É)</label>
              <div class="tags-wrap" id="profileTags"></div>
            </div>
            <button class="btn btn-primary" onclick="saveProfile()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
          </div>
        </div>
        <div class="tc" id="pt-socials">
          <div class="card">
            <div id="socialsList"></div>
            <div style="border-top:1px solid #f0f0f8;margin-top:16px;padding-top:16px">
              <div class="st" style="margin-bottom:12px">–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ü—Å–µ—Ç—å</div>
              <div class="fr">
                <div class="fg">
                  <label class="fl">–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞</label>
                  <select class="fi" id="addSocPlatform">
                    <option>Telegram</option>
                    <option>YouTube</option>
                    <option>VK</option>
                    <option>–Ø–Ω–¥–µ–∫—Å.–î–∑–µ–Ω</option>
                    <option>Instagram</option>
                    <option>TikTok</option>
                    <option>Twitter/X</option>
                  </select>
                </div>
                <div class="fg"><label class="fl">–°—Å—ã–ª–∫–∞ / username</label><input class="fi" id="addSocLink" placeholder="https://t.me/username"></div>
              </div>
              <div class="fr">
                <div class="fg"><label class="fl">–ü–æ–¥–ø–∏—Å—á–∏–∫–∏</label><input class="fi" id="addSocSubs" type="number" placeholder="15000"></div>
                <div class="fg"><label class="fl">–ü—Ä–æ—Å–º–æ—Ç—Ä—ã / –æ—Ö–≤–∞—Ç</label><input class="fi" id="addSocViews" placeholder="8 000"></div>
              </div>
              <button class="btn btn-primary btn-sm" onclick="addSocial()">+ –î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
          </div>
        </div>
        <div class="tc" id="pt-prices">
          <div class="card">
            <div id="pricesList"></div>
            <div style="border-top:1px solid #f0f0f8;margin-top:16px;padding-top:16px">
              <div class="st" style="margin-bottom:12px">–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç</div>
              <div class="fr">
                <div class="fg"><label class="fl">–ù–∞–∑–≤–∞–Ω–∏–µ</label><input class="fi" id="addPriceName" placeholder="–ü–æ—Å—Ç –≤ Telegram"></div>
                <div class="fg"><label class="fl">–¶–µ–Ω–∞ (‚ÇΩ)</label><input class="fi" type="number" id="addPriceVal" placeholder="10000"></div>
              </div>
              <div class="fg"><label class="fl">–û–ø–∏—Å–∞–Ω–∏–µ</label><input class="fi" id="addPriceDesc" placeholder="–ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç —Ñ–æ—Ä–º–∞—Ç..."></div>
              <button class="btn btn-primary btn-sm" onclick="addPrice()">+ –î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
          </div>
        </div>
      </div>

      <!-- b-campaigns -->
      <div class="tc" id="b-campaigns">
        <div class="ph"><h1>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–∞–º–ø–∞–Ω–∏–∏</h1><p>–û—Ç–∫–ª–∏–∫–Ω–∏—Ç–µ—Å—å –Ω–∞ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</p></div>
        <div class="filter-bar">
          <label>–ù–∏—à–∞:</label>
          <select class="fi-sm" id="bCampFilterNiche" onchange="renderBloggerCampaigns()">
            <option value="">–í—Å–µ</option>
            <option value="–∫—Ä–∏–ø—Ç–æ">–ö—Ä–∏–ø—Ç–æ</option>
            <option value="–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏">–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏</option>
            <option value="DeFi">DeFi</option>
          </select>
          <label>–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞:</label>
          <select class="fi-sm" id="bCampFilterPlat" onchange="renderBloggerCampaigns()">
            <option value="">–õ—é–±–∞—è</option>
            <option value="Telegram">Telegram</option>
            <option value="YouTube">YouTube</option>
            <option value="VK">VK</option>
          </select>
          <label>–°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å:</label>
          <select class="fi-sm" id="bCampSort" onchange="renderBloggerCampaigns()">
            <option value="budget_desc">–ë—é–¥–∂–µ—Ç: —Å–Ω–∞—á–∞–ª–∞ –±–æ–ª—å—à–µ</option>
            <option value="budget_asc">–ë—é–¥–∂–µ—Ç: —Å–Ω–∞—á–∞–ª–∞ –º–µ–Ω—å—à–µ</option>
            <option value="date">–ü–æ –¥–µ–¥–ª–∞–π–Ω—É</option>
          </select>
        </div>
        <div id="bCampaignsList"></div>
      </div>

      <!-- b-deals -->
      <div class="tc" id="b-deals">
        <div class="ph-row">
          <div class="ph"><h1>–ú–æ–∏ —Å–¥–µ–ª–∫–∏</h1></div>
          <button class="btn btn-secondary btn-sm" onclick="bTab('dashboard',document.querySelectorAll('#page-blogger .si')[0])">‚Üê –ù–∞ –¥–∞—à–±–æ—Ä–¥</button>
        </div>
        <div class="deal-card">
          <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px">
            <div>
              <div style="font-size:16px;font-weight:800">BingX Exchange ‚Üí –ü–æ—Å—Ç –≤ Telegram</div>
              <div style="font-size:12px;color:#888;margin-top:3px">–°–æ–∑–¥–∞–Ω–∞: 20 —Ñ–µ–≤ 2026 ¬∑ –î–µ–¥–ª–∞–π–Ω: 1 –º–∞—Ä 2026</div>
            </div>
            <span class="b y">–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏</span>
          </div>
          <div style="background:#f9f9fc;border-radius:8px;padding:12px;margin-bottom:14px">
            <div style="font-size:12px;font-weight:700;color:#888;margin-bottom:6px">üìã –¢–ó –æ—Ç —ç–º–∏—Ç–µ–Ω—Ç–∞:</div>
            <div style="font-size:13px;color:#444;line-height:1.6">–ù–∞–ø–∏—Å–∞—Ç—å –Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ—Å—Ç –≤ Telegram –æ BingX Exchange. –£–ø–æ–º—è–Ω—É—Ç—å: —Ç–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã BTC/USDT, ETH/USDT, –∫–µ—à–±—ç–∫ 20%, —Ä–µ—Ñ. –ø—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ 45%. –î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É —Å UTM. –û–±—ä—ë–º 300‚Äì500 —Å–∏–º–≤–æ–ª–æ–≤. –°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç –¥–æ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏.</div>
          </div>
          <div style="background:#f0f4ff;border-radius:8px;padding:10px 14px;margin-bottom:14px;font-size:13px">
            <div style="display:flex;justify-content:space-between"><span style="color:#555">–í–∞—à –≥–æ–Ω–æ—Ä–∞—Ä:</span><span style="font-weight:800;color:#16a34a">‚ÇΩ10 000</span></div>
            <div style="display:flex;justify-content:space-between;color:#888;margin-top:3px"><span>–ö–æ–º–∏—Å—Å–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (+10%, –º–∏–Ω.):</span><span>‚ÇΩ1 000 ‚Äî –ø–ª–∞—Ç–∏—Ç —ç–º–∏—Ç–µ–Ω—Ç</span></div>
          </div>
          <div style="display:flex;gap:8px;margin-bottom:14px">
            <button class="btn btn-success btn-sm" onclick="showToast('‚úì –°–¥–µ–ª–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞!')">‚úì –ü—Ä–∏–Ω—è—Ç—å</button>
            <button class="btn btn-secondary btn-sm" onclick="showToast('‚úó –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ')">‚úó –û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
            <button class="btn btn-danger btn-sm" style="margin-left:auto" onclick="openDisputeModal(1)">‚ö†Ô∏è –û—Ç–∫—Ä—ã—Ç—å —Å–ø–æ—Ä</button>
          </div>
          <div class="chat-wrap">
            <div class="chat-msgs" id="dealChatMsgs">
              <div class="chat-msg in"><b>BingX Exchange</b><br>–ü—Ä–∏–≤–µ—Ç! –í—ã—Å—ã–ª–∞—é –¢–ó –Ω–∞ –ø–æ—Å—Ç. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–æ–≥–ª–∞—Å—É–π—Ç–µ —Ç–µ–∫—Å—Ç –¥–æ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏.<br><div onclick="mockDownload('–¢–ó_BingX_–í–µ—Å–Ω–∞2026.docx')" style="display:inline-flex;align-items:center;gap:5px;background:rgba(0,0,0,.06);border-radius:6px;padding:4px 8px;margin-top:4px;cursor:pointer;font-size:12px;font-weight:600;border:1px solid #e0e0e0" title="–ù–∞–∂–º–∏—Ç–µ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è">üìÑ –¢–ó_BingX_–í–µ—Å–Ω–∞2026.docx</div><div class="msg-time">20 —Ñ–µ–≤, 14:32</div></div>
              <div class="chat-msg out">–ü–æ–ª—É—á–∏–ª, –∏–∑—É—á—É —Å–µ–≥–æ–¥–Ω—è –∏ –Ω–∞–ø–∏—à—É –Ω–∞–±—Ä–æ—Å–æ–∫.<div class="msg-time">20 —Ñ–µ–≤, 15:10</div></div>
              <div class="chat-msg in">–û—Ç–ª–∏—á–Ω–æ! –ñ–¥—É üôå<div class="msg-time">20 —Ñ–µ–≤, 15:12</div></div>
            </div>
            <div id="chatAttachChips" style="display:none;padding:6px 12px 0;background:#fff;display:none;flex-wrap:wrap;gap:6px"></div>
            <div class="chat-input-row">
              <button class="btn btn-secondary btn-sm" onclick="document.getElementById('chatFileInput').click()" title="–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª" style="flex-shrink:0;padding:6px 10px;font-size:16px">üìé</button>
              <input type="file" id="chatFileInput" accept=".doc,.docx,.pptx,.pdf,.xlsx,.png,.jpg,.jpeg" style="display:none" onchange="attachChatFile(this)">
              <input class="chat-input" id="chatInput" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ..." onkeydown="if(event.key==='Enter')sendChatMsg()" style="flex:1">
              <button class="btn btn-primary btn-sm" onclick="sendChatMsg()" style="flex-shrink:0">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ADMIN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="page" id="page-admin">
  <div class="app-layout">
    <div class="sidebar">
      <div class="ss">–ú–µ–Ω—é</div>
      <div class="si active" onclick="aTab('dashboard',this)"><span>üìä</span> –î–∞—à–±–æ—Ä–¥</div>
      <div class="si" onclick="aTab('verify',this)"><span>‚úÖ</span> –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è <span id="verifyBadgeSidebar" class="b r" style="margin-left:auto;font-size:10px;padding:1px 6px"></span></div>
      <div class="si" onclick="aTab('disputes',this)"><span>‚ö†Ô∏è</span> –°–ø–æ—Ä—ã</div>
      <div class="si" onclick="aTab('users',this)"><span>üë•</span> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</div>
      <div class="si" onclick="aTab('commissions',this)"><span>‚öôÔ∏è</span> –ö–æ–º–∏—Å—Å–∏–∏</div>
      <div class="si" onclick="aTab('tags',this)"><span>üè∑Ô∏è</span> –¢–µ–≥–∏ –∞–≤—Ç–æ—Ä–æ–≤</div>
    </div>
    <div class="main">

      <!-- a-dashboard -->
      <div class="tc active" id="a-dashboard">
        <div class="ph"><h1>–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h1><p>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</p></div>
        <div class="sc-grid">
          <button class="sc c1 sc-btn" id="statBtn-users" title="–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"><div class="v" id="aStatUsers">6</div><div class="l">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚Üó</div></button>
          <button class="sc c3 sc-btn" id="statBtn-bloggers" title="–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–ª–æ–≥–µ—Ä–æ–≤"><div class="v">3</div><div class="l">–ë–ª–æ–≥–µ—Ä–æ–≤ ‚Üó</div></button>
          <button class="sc c4 sc-btn" id="statBtn-issuers" title="–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —ç–º–∏—Ç–µ–Ω—Ç–æ–≤"><div class="v">2</div><div class="l">–≠–º–∏—Ç–µ–Ω—Ç–æ–≤ ‚Üó</div></button>
          <button class="sc c2 sc-btn" id="statBtn-escrow" title="–û–±—ä—ë–º —ç—Å–∫—Ä–æ—É"><div class="v">‚ÇΩ11 000</div><div class="l">–û–±—ä—ë–º —ç—Å–∫—Ä–æ—É ‚Üó</div></button>
        </div>
        <div class="g2" style="margin-bottom:20px">
          <div class="chart-box">
            <div class="chart-title">üìà –û–±—ä—ë–º —Å–¥–µ–ª–æ–∫ –ø–æ –º–µ—Å—è—Ü–∞–º (‚ÇΩ)</div>
            <canvas id="chartDeals" width="340" height="180"></canvas>
          </div>
          <div class="chart-box">
            <div class="chart-title">üë• –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
            <canvas id="chartUsers" width="340" height="180"></canvas>
          </div>
        </div>
        <div class="g2">
          <div class="chart-box">
            <div class="chart-title">üí∞ –ö–æ–º–∏—Å—Å–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (‚ÇΩ)</div>
            <canvas id="chartComm" width="340" height="160"></canvas>
          </div>
          <div class="card" style="margin-bottom:0">
            <div class="ct">‚è≥ –û–∂–∏–¥–∞—é—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏</div>
            <div id="adminVerifyQueue"></div>
          </div>
        </div>
      </div>

      <!-- a-verify -->
      <div class="tc" id="a-verify">
        <div class="ph"><h1>–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —ç–º–∏—Ç–µ–Ω—Ç–æ–≤</h1></div>
        <div class="card" id="aVerifyCard"></div>
      </div>

      <!-- a-disputes -->
      <div class="tc" id="a-disputes">
        <div class="ph-row">
          <div class="ph"><h1>–°–ø–æ—Ä—ã</h1><p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞–º–∏ –º–µ–∂–¥—É —Å—Ç–æ—Ä–æ–Ω–∞–º–∏</p></div>
          <span class="b r" id="disputeCount">2 –æ—Ç–∫—Ä—ã—Ç—ã—Ö</span>
        </div>
        <div id="aDisputesList"></div>
      </div>

      <!-- a-users -->
      <div class="tc" id="a-users">
        <div class="ph"><h1>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h1><p>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–æ–∫—É –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ—Ç–∞–ª–µ–π</p></div>
        <div class="card"><div id="aUsersList"></div></div>
      </div>

      <!-- a-commissions -->
      <div class="tc" id="a-commissions">
        <div class="ph"><h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∏—Å—Å–∏—è–º–∏</h1><p>–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ –¥–ª—è –±–ª–æ–≥–µ—Ä–æ–≤ –∏ —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã—Ö —É—Å–ª—É–≥</p></div>

        <!-- –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ -->
        <div class="card" style="margin-bottom:20px">
          <div class="ct">üåê –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</div>
          <div style="display:flex;align-items:center;gap:16px;flex-wrap:wrap">
            <div style="flex:1;min-width:200px">
              <div style="font-size:13px;color:#888;margin-bottom:6px">–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º —Å–¥–µ–ª–∫–∞–º –±–µ–∑ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–π —Å—Ç–∞–≤–∫–∏</div>
              <div style="display:flex;align-items:center;gap:8px">
                <input class="fi" type="number" id="globalCommInput" min="0" max="50" step="0.5" value="10" style="width:100px">
                <span style="font-size:16px;font-weight:700">%</span>
                <button class="btn btn-primary btn-sm" onclick="saveGlobalComm()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
              </div>
            </div>
            <div class="sc c2" style="padding:14px;min-width:140px">
              <div class="v" id="globalCommDisplay">10%</div>
              <div class="l">–¢–µ–∫—É—â–∞—è —Å—Ç–∞–≤–∫–∞</div>
            </div>
          </div>
        </div>

        <!-- –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ –±–ª–æ–≥–µ—Ä–æ–≤ -->
        <div class="card" style="margin-bottom:20px">
          <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:14px;flex-wrap:wrap">
            <div class="ct" style="margin-bottom:0">üë§ –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Å—Ç–∞–≤–∫–∏ –¥–ª—è –±–ª–æ–≥–µ—Ä–æ–≤</div>
            <input class="fi" id="commBloggerSearch" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ –Ω–∏—à–µ..." oninput="renderBloggerCommList(this.value)" style="max-width:260px;padding:7px 12px;font-size:13px">
          </div>
          <div style="font-size:13px;color:#888;margin-bottom:12px">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–æ–∫—É –±–ª–æ–≥–µ—Ä–∞ —á—Ç–æ–±—ã —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∏ –∑–∞–¥–∞—Ç—å —Å—Ç–∞–≤–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —É—Å–ª—É–≥–∏ –æ—Ç–¥–µ–ª—å–Ω–æ.</div>
          <div id="bloggerCommList"></div>
        </div>

        <!-- –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ —É—Å–ª—É–≥–∏ -->
        <div class="card">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:14px">
            <div class="ct" style="margin-bottom:0">üåü –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ —É—Å–ª—É–≥–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</div>
            <button class="btn btn-primary btn-sm" onclick="addExclusiveService()">+ –î–æ–±–∞–≤–∏—Ç—å</button>
          </div>
          <div style="font-size:13px;color:#888;margin-bottom:14px">–£—Å–ª—É–≥–∏, —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –Ω–∞—à—É –±–∏—Ä–∂—É. –ú–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é —Å—Ç–∞–≤–∫—É –∫–æ–º–∏—Å—Å–∏–∏.</div>
          <div id="exclusiveServicesList"></div>
        </div>
      </div>

      <!-- a-tags -->
      <div class="tc" id="a-tags">
        <div class="ph"><h1>–¢–µ–≥–∏ –∞–≤—Ç–æ—Ä–æ–≤</h1><p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ —Ç–µ–≥–∞–º–∏ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–µ–π –±–ª–æ–≥–µ—Ä–æ–≤</p></div>
        <div class="card" style="margin-bottom:20px">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;flex-wrap:wrap;gap:10px">
            <div class="ct" style="margin-bottom:0">üè∑Ô∏è –í—Å–µ —Ç–µ–≥–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</div>
            <button class="btn btn-primary btn-sm" onclick="addAdminTag()">+ –î–æ–±–∞–≤–∏—Ç—å —Ç–µ–≥</button>
          </div>
          <div style="font-size:13px;color:#888;margin-bottom:14px">–ë–ª–æ–≥–µ—Ä—ã –≤—ã–±–∏—Ä–∞—é—Ç –∏–∑ —ç—Ç–∏—Ö —Ç–µ–≥–æ–≤ –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è. –ú–∞–∫—Å–∏–º—É–º 8 —Ç–µ–≥–æ–≤ –Ω–∞ –∞–≤—Ç–æ—Ä–∞.</div>
          <div id="adminTagsList" style="display:flex;flex-wrap:wrap;gap:8px"></div>
        </div>
        <div class="card">
          <div class="ct" style="margin-bottom:12px">üìä –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å —Ç–µ–≥–æ–≤</div>
          <div id="adminTagsStats" style="display:flex;flex-wrap:wrap;gap:8px"></div>
        </div>
      </div>

    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODAL: BLOGGER DETAIL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="mo" id="mBlogger">
  <div class="modal modal-wide">
    <div class="mh">
      <div><h2 id="mBName" style="font-size:22px;font-weight:800"></h2><p id="mBSub" style="font-size:14px;color:#888;margin-top:4px"></p></div>
      <button class="mc" onclick="closeModal('mBlogger')">√ó</button>
    </div>
    <div id="mBBody"></div>
    <div style="margin-top:20px;padding-top:16px;border-top:1px solid #f0f0f8">
      <button class="btn btn-primary" style="width:100%;padding:12px" onclick="closeModal('mBlogger');openDealModal()">ü§ù –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Å–¥–µ–ª–∫—É</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODAL: CAMPAIGN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="mo" id="mCampaign">
  <div class="modal">
    <div class="mh"><h2 style="font-size:20px;font-weight:800">–ù–æ–≤–∞—è –∫–∞–º–ø–∞–Ω–∏—è</h2><button class="mc" onclick="closeModal('mCampaign')">√ó</button></div>
    <div class="fg"><label class="fl">–ù–∞–∑–≤–∞–Ω–∏–µ *</label><input class="fi" id="campName" placeholder="BingX ‚Äî –æ—Å–µ–Ω–Ω–∏–π –Ω–∞–±–æ—Ä"></div>
    <div class="fg"><label class="fl">–û–ø–∏—Å–∞–Ω–∏–µ *</label><textarea class="fi" id="campDesc" rows="3" placeholder="–ß—Ç–æ –Ω—É–∂–Ω–æ —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å –±–ª–æ–≥–µ—Ä–∞–º..."></textarea></div>
    <div class="fg">
      <label class="fl">–ù–∏—à–∞ / –¢–µ–º–∞—Ç–∏–∫–∞</label>
      <select class="fi" id="campNiche">
        <option value="–∫—Ä–∏–ø—Ç–æ">–ö—Ä–∏–ø—Ç–æ</option>
        <option value="–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏">–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏</option>
        <option value="DeFi">DeFi / Web3</option>
        <option value="—Ç—Ä–µ–π–¥–∏–Ω–≥">–¢—Ä–µ–π–¥–∏–Ω–≥</option>
      </select>
    </div>
    <div class="fr">
      <div class="fg"><label class="fl">–ë—é–¥–∂–µ—Ç –Ω–∞ –±–ª–æ–≥–µ—Ä–∞ (‚ÇΩ) *</label><input class="fi" type="number" id="campBudget" placeholder="25000"></div>
      <div class="fg"><label class="fl">–ù—É–∂–Ω–æ –±–ª–æ–≥–µ—Ä–æ–≤</label><input class="fi" type="number" id="campCount" value="5"></div>
    </div>
    <div class="fr">
      <div class="fg"><label class="fl">–î–µ–¥–ª–∞–π–Ω</label><input class="fi" type="date" id="campDeadline"></div>
      <div class="fg"><label class="fl">–ü–ª–∞—Ç—Ñ–æ—Ä–º—ã</label>
        <select class="fi" id="campPlatform">
          <option>Telegram</option>
          <option>YouTube</option>
          <option>VK</option>
          <option>–Ø–Ω–¥–µ–∫—Å.–î–∑–µ–Ω</option>
          <option>–õ—é–±–∞—è</option>
        </select>
      </div>
    </div>
    <div class="fg" style="display:flex;align-items:center;gap:8px"><label style="display:flex;align-items:center;gap:8px;font-size:14px;cursor:pointer"><input type="checkbox" style="width:16px;height:16px;accent-color:#6366f1"> <span>–ü—Ä–∏–≤–∞—Ç–Ω–∞—è –∫–∞–º–ø–∞–Ω–∏—è <span style="font-size:11px;color:#a855f7;font-weight:700">(PRO)</span></span></label></div>
    <button class="btn btn-primary" style="width:100%;padding:12px;margin-top:8px" onclick="createCampaign()">–°–æ–∑–¥–∞—Ç—å –∫–∞–º–ø–∞–Ω–∏—é</button>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODAL: DEAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="mo" id="mDeal">
  <div class="modal">
    <div class="mh">
      <div><h2 style="font-size:20px;font-weight:800">–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Å–¥–µ–ª–∫—É</h2><p id="mDealFor" style="font-size:14px;color:#888"></p></div>
      <button class="mc" onclick="closeModal('mDeal')">√ó</button>
    </div>
    <div class="fg">
      <label class="fl">1Ô∏è‚É£ –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ü—Å–µ—Ç—å / –∫–∞–Ω–∞–ª –±–ª–æ–≥–µ—Ä–∞</label>
      <select class="fi" id="dealSocial" onchange="filterDealFormats(this.value)">
        <option value="">‚Äî –≤—ã–±–µ—Ä–∏—Ç–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É ‚Äî</option>
      </select>
    </div>
    <div class="fg">
      <label class="fl">2Ô∏è‚É£ –§–æ—Ä–º–∞—Ç —Ä–∞–∑–º–µ—â–µ–Ω–∏—è</label>
      <select class="fi" id="dealFormat" onchange="setDealFormat()">
        <option value="">‚Äî —Å–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ü—Å–µ—Ç—å ‚Äî</option>
      </select>
    </div>
    <div class="fg">
      <label class="fl">–°—É–º–º–∞ –±–ª–æ–≥–µ—Ä–∞ (‚ÇΩ) *</label>
      <input class="fi" type="number" id="dealAmt" placeholder="10000" oninput="calcComm()">
      <div id="specProjHint" style="display:none;margin-top:6px;padding:8px 12px;background:#f0f0ff;border-radius:8px;font-size:12px;color:#6366f1">
        üíº <b>–°–ø–µ—Ü–ø—Ä–æ–µ–∫—Ç:</b> –í–≤–µ–¥–∏—Ç–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—É—é —Å –±–ª–æ–≥–µ—Ä–æ–º —Å—É–º–º—É. –ö–æ–º–∏—Å—Å–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –±—É–¥–µ—Ç —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
      </div>
    </div>
    <div class="comm-box" id="commBox" style="display:none">
      <div class="comm-row"><span style="color:#555">–ì–æ–Ω–æ—Ä–∞—Ä –∞–≤—Ç–æ—Ä–∞:</span><span id="c-blogger" style="font-weight:700;color:#16a34a"></span></div>
      <div class="comm-row"><span style="color:#888" id="c-comm-label">–ö–æ–º–∏—Å—Å–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã:</span><span id="c-comm" style="color:#888"></span></div>
      <div class="comm-row total"><span>–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ —ç–º–∏—Ç–µ–Ω—Ç–æ–º:</span><span id="c-total" style="color:#6366f1"></span></div>
    </div>
    <div class="fg"><label class="fl">–î–µ–¥–ª–∞–π–Ω</label><input class="fi" type="date" id="dealDeadline"></div>
    <div class="fg"><label class="fl">üìã –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ (–¢–ó) *</label><textarea class="fi" id="dealTZ" rows="4" placeholder="–û–ø–∏—à–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ: —á—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ —É–ø–æ–º—è–Ω—É—Ç—å, —Å—Å—ã–ª–∫–∏, —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ç–µ–∫—Å—Ç—É/–≤–∏–¥–µ–æ..."></textarea></div>
    <button class="btn btn-primary" style="width:100%;padding:12px" onclick="sendDeal()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</button>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODAL: ADD EXCLUSIVE SERVICE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="mo" id="mAddExcl">
  <div class="modal">
    <div class="mh">
      <div><h2 style="font-size:20px;font-weight:800">üåü –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–∞—è —É—Å–ª—É–≥–∞</h2><p style="font-size:13px;color:#888">–£—Å–ª—É–≥–∞, –¥–æ—Å—Ç—É–ø–Ω–∞—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –Ω–∞—à—É –±–∏—Ä–∂—É</p></div>
      <button class="mc" onclick="closeModal('mAddExcl')">√ó</button>
    </div>
    <div class="fg"><label class="fl">–ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏ *</label><input class="fi" type="text" id="exclName" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø–æ–¥–∫–∞—Å—Ç BCS"></div>
    <div class="fg"><label class="fl">–û–ø–∏—Å–∞–Ω–∏–µ</label><textarea class="fi" id="exclDesc" rows="2" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ –∏ —É—Å–ª–æ–≤–∏–π..."></textarea></div>
    <div class="fg"><label class="fl">–ü—Ä–∏–≤—è–∑–∞—Ç—å –∫ –±–ª–æ–≥–µ—Ä—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
      <select class="fi" id="exclBlogger">
        <option value="">‚Äî –î–æ—Å—Ç—É–ø–Ω–æ –≤—Å–µ–º –ø–æ–¥—Ö–æ–¥—è—â–∏–º –±–ª–æ–≥–µ—Ä–∞–º ‚Äî</option>
      </select>
    </div>
    <div style="display:flex;gap:12px">
      <div class="fg" style="flex:1"><label class="fl">–°—Ç–æ–∏–º–æ—Å—Ç—å (‚ÇΩ)</label><input class="fi" type="number" id="exclPrice" placeholder="50000" min="0"></div>
      <div class="fg" style="flex:1"><label class="fl">–°—Ç–∞–≤–∫–∞ –∫–æ–º–∏—Å—Å–∏–∏ (%)</label><input class="fi" type="number" id="exclComm" placeholder="10" min="0" max="50" step="0.5" value="10"></div>
    </div>
    <button class="btn btn-primary" style="width:100%;padding:12px" onclick="submitAddExclusiveService()">‚úì –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—É—é —É—Å–ª—É–≥—É</button>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODAL: APPLY TO CAMPAIGN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="mo" id="mApply">
  <div class="modal">
    <div class="mh">
      <div><h2 style="font-size:20px;font-weight:800">–û—Ç–∫–ª–∏–∫–Ω—É—Ç—å—Å—è –Ω–∞ –∫–∞–º–ø–∞–Ω–∏—é</h2><p id="mApplyFor" style="font-size:14px;color:#888"></p></div>
      <button class="mc" onclick="closeModal('mApply')">√ó</button>
    </div>
    <div class="fg">
      <label class="fl">–ß–µ—Ä–µ–∑ –∫–∞–∫—É—é —Å–æ—Ü—Å–µ—Ç—å –≤—ã–ø–æ–ª–Ω—é?</label>
      <select class="fi" id="applySocial" onchange="filterApplyFormats(this.value)">
        <option value="">‚Äî –≤—ã–±–µ—Ä–∏—Ç–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É ‚Äî</option>
      </select>
    </div>
    <div class="fg">
      <label class="fl">–§–æ—Ä–º–∞—Ç —Ä–∞–∑–º–µ—â–µ–Ω–∏—è</label>
      <select class="fi" id="applyFormat">
        <option value="">‚Äî –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç ‚Äî</option>
      </select>
    </div>
    <div class="fg"><label class="fl">–°–æ–ø—Ä–æ–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–∏—Å—å–º–æ</label><textarea class="fi" rows="3" id="applyCover" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –ø–æ—á–µ–º—É –ø–æ–¥—Ö–æ–¥–∏—Ç–µ –¥–ª—è —ç—Ç–æ–π –∫–∞–º–ø–∞–Ω–∏–∏..."></textarea></div>
    <div style="background:#f0f4ff;border-radius:8px;padding:10px 14px;margin-bottom:16px;font-size:13px">
      ‚ÑπÔ∏è –ü–æ—Å–ª–µ –ø—Ä–∏–Ω—è—Ç–∏—è –∑–∞—è–≤–∫–∏ —ç–º–∏—Ç–µ–Ω—Ç –ø—Ä–∏—à–ª—ë—Ç –¢–ó –∏ –æ–±—Å—É–¥–∏—Ç –¥–µ—Ç–∞–ª–∏ –≤ —á–∞—Ç–µ.
    </div>
    <button class="btn btn-primary" style="width:100%;padding:12px" onclick="submitApply()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É</button>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODAL: USER DETAIL (ADMIN) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="mo" id="mUser">
  <div class="modal">
    <div class="mh"><h2 style="font-size:20px;font-weight:800" id="mUserTitle">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h2><button class="mc" onclick="closeModal('mUser')">√ó</button></div>
    <div id="mUserBody"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODAL: CAMPAIGN DETAIL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="mo" id="mCampDetail">
  <div class="modal modal-wide">
    <div class="mh"><h2 style="font-size:20px;font-weight:800" id="mCampDetailTitle">–ö–∞–º–ø–∞–Ω–∏—è</h2><button class="mc" onclick="closeModal('mCampDetail')">√ó</button></div>
    <div id="mCampDetailBody"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODAL: EARNINGS HISTORY ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="mo" id="mEarnings">
  <div class="modal">
    <div class="mh"><h2 style="font-size:20px;font-weight:800">üí∞ –ò—Å—Ç–æ—Ä–∏—è –∑–∞—Ä–∞–±–æ—Ç–∫–∞</h2><button class="mc" onclick="closeModal('mEarnings')">√ó</button></div>
    <div class="sc-grid" style="grid-template-columns:repeat(3,1fr);margin-bottom:16px">
      <div class="sc c2"><div class="v">‚ÇΩ30K</div><div class="l">–í—Å–µ–≥–æ</div></div>
      <div class="sc c1"><div class="v">3</div><div class="l">–°–¥–µ–ª–æ–∫</div></div>
      <div class="sc c4"><div class="v">‚ÇΩ10K</div><div class="l">–°—Ä–µ–¥–Ω—è—è</div></div>
    </div>
    <table class="tbl">
      <thead><tr><th>–î–∞—Ç–∞</th><th>–≠–º–∏—Ç–µ–Ω—Ç</th><th>–§–æ—Ä–º–∞—Ç</th><th>–°—É–º–º–∞</th><th>–°—Ç–∞—Ç—É—Å</th></tr></thead>
      <tbody>
        <tr><td>20 —è–Ω–≤ 2026</td><td>BingX Exchange</td><td>Telegram –ø–æ—Å—Ç</td><td style="font-weight:700;color:#16a34a">‚ÇΩ10 000</td><td><span class="b g">–í—ã–ø–ª–∞—á–µ–Ω–æ</span></td></tr>
        <tr><td>5 —Ñ–µ–≤ 2026</td><td>BingX Exchange</td><td>YouTube –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è</td><td style="font-weight:700;color:#16a34a">‚ÇΩ20 000</td><td><span class="b g">–í—ã–ø–ª–∞—á–µ–Ω–æ</span></td></tr>
        <tr><td>20 —Ñ–µ–≤ 2026</td><td>BingX Exchange</td><td>Telegram –ø–æ—Å—Ç</td><td style="font-weight:700;color:#d97706">‚ÇΩ10 000</td><td><span class="b y">–í —ç—Å–∫—Ä–æ—É</span></td></tr>
      </tbody>
    </table>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODAL: COMPLETED DEALS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="mo" id="mCompletedDeals">
  <div class="modal">
    <div class="mh"><h2 style="font-size:20px;font-weight:800">‚úÖ –ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ —Å–¥–µ–ª–∫–∏</h2><button class="mc" onclick="closeModal('mCompletedDeals')">√ó</button></div>
    <div class="deal-card" style="border-left-color:#16a34a">
      <div style="display:flex;justify-content:space-between;margin-bottom:8px">
        <div><div style="font-weight:700">BingX Exchange ‚Üí YouTube –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è</div><div style="font-size:12px;color:#888">–ó–∞–≤–µ—Ä—à–µ–Ω–∞ 10 —Ñ–µ–≤ 2026</div></div>
        <span class="b g">‚úì –í—ã–ø–ª–∞—á–µ–Ω–æ</span>
      </div>
      <div style="font-size:13px;color:#555">–ì–æ–Ω–æ—Ä–∞—Ä: <b style="color:#16a34a">‚ÇΩ20 000</b></div>
      <div style="margin-top:8px"><span class="b gr">‚òÖ 5.0 ‚Äî –æ—Ü–µ–Ω–∫–∞ —ç–º–∏—Ç–µ–Ω—Ç–∞</span></div>
    </div>
    <div class="deal-card" style="border-left-color:#16a34a">
      <div style="display:flex;justify-content:space-between;margin-bottom:8px">
        <div><div style="font-weight:700">BingX Exchange ‚Üí Telegram –ø–æ—Å—Ç</div><div style="font-size:12px;color:#888">–ó–∞–≤–µ—Ä—à–µ–Ω–∞ 25 —è–Ω–≤ 2026</div></div>
        <span class="b g">‚úì –í—ã–ø–ª–∞—á–µ–Ω–æ</span>
      </div>
      <div style="font-size:13px;color:#555">–ì–æ–Ω–æ—Ä–∞—Ä: <b style="color:#16a34a">‚ÇΩ10 000</b></div>
      <div style="margin-top:8px"><span class="b gr">‚òÖ 4.5 ‚Äî –æ—Ü–µ–Ω–∫–∞ —ç–º–∏—Ç–µ–Ω—Ç–∞</span></div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODAL: OPEN DISPUTE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="mo" id="mOpenDispute">
  <div class="modal">
    <div class="mh"><h2 style="font-size:20px;font-weight:800" id="mOpenDisputeTitle">–û—Ç–∫—Ä—ã—Ç—å —Å–ø–æ—Ä</h2><button class="mc" onclick="closeModal('mOpenDispute')">√ó</button></div>
    <div id="mOpenDisputeBody"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODAL: DISPUTE DETAIL (ADMIN) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="mo" id="mDisputeDetail">
  <div class="modal modal-wide" style="max-width:700px">
    <div class="mh"><h2 style="font-size:20px;font-weight:800" id="mDisputeTitle">–°–ø–æ—Ä</h2><button class="mc" onclick="closeModal('mDisputeDetail')">√ó</button></div>
    <div id="mDisputeBody" style="max-height:70vh;overflow-y:auto"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODAL: ADMIN STAT DETAIL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="mo" id="mAdminStat">
  <div class="modal modal-wide" style="max-width:700px">
    <div class="mh"><h2 style="font-size:20px;font-weight:800" id="mAdminStatTitle">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2><button class="mc" onclick="closeModal('mAdminStat')">√ó</button></div>
    <div id="mAdminStatBody" style="max-height:70vh;overflow-y:auto"></div>
  </div>
</div>

<!-- TOAST -->
<div id="toast" style="position:fixed;bottom:24px;right:24px;background:#1a1a2e;color:#fff;padding:12px 20px;border-radius:12px;font-size:14px;font-weight:600;z-index:999;transform:translateY(80px);opacity:0;transition:.3s;max-width:320px;box-shadow:0 8px 24px rgba(0,0,0,.2)"></div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const PLATFORM_ICONS = {
  'Telegram':'üì±','YouTube':'‚ñ∂Ô∏è','VK':'üî∑','–Ø–Ω–¥–µ–∫—Å.–î–∑–µ–Ω':'üü°','Instagram':'üì∏','TikTok':'üéµ','Twitter/X':'üê¶'
};

const BLOGGERS = [
  {id:1, n:'–ö—Ä–∏–ø—Ç–æ –ë–ª–æ–≥–µ—Ä 1', niche:'–∫—Ä–∏–ø—Ç–æ', geo:'–†–æ—Å—Å–∏—è', tg:'@cryptoblogger1', r:4.3, deals:3,
   tags:['–∫—Ä–∏–ø—Ç–æ','–±–∏—Ä–∂–∏','DeFi','–æ–±–∑–æ—Ä—ã'],
   s:[
     {plat:'Telegram',link:'@cryptoblogger1',subs:15000,views:'8 000 –ø—Ä–æ—Å–º.',er:'5.2%',verified:true},
     {plat:'YouTube',link:'CryptoBlogger1',subs:25000,views:'12 000 –ø—Ä–æ—Å–º.',er:'4.1%',verified:false},
     {plat:'VK',link:'vk.com/cryptob1',subs:8000,views:'3 500 –ø—Ä–æ—Å–º.',er:'2.1%',verified:false}
   ],
   p:[{n:'–ü–æ—Å—Ç –≤ Telegram',d:'–ù–∞—Ç–∏–≤–Ω—ã–π —Ä–µ–∫–ª–∞–º–Ω—ã–π –ø–æ—Å—Ç —Å —Å—Å—ã–ª–∫–æ–π ¬∑ 1 –¥–µ–Ω—å',p:10000,plat:'Telegram'},
      {n:'–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ YouTube',d:'–†–µ–∫–ª–∞–º–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è 60-90 —Å–µ–∫ ¬∑ 7 –¥–Ω–µ–π',p:20000,plat:'YouTube'},
      {n:'YouTube Shorts',d:'–ö–æ—Ä–æ—Ç–∫–æ–µ –≤–∏–¥–µ–æ —Å —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ–º ¬∑ 3 –¥–Ω—è',p:8000,plat:'YouTube'},
      {n:'–ü–æ—Å—Ç –≤ VK',d:'–¢–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ—Å—Ç —Å —Ñ–æ—Ç–æ ¬∑ 1 –¥–µ–Ω—å',p:6000,plat:'VK'},
      {n:'–°–ø–µ—Ü–ø—Ä–æ–µ–∫—Ç',d:'–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è ‚Äî –æ–≥–æ–≤–∞—Ä–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ',p:0,plat:'*'}]},
  {id:2, n:'–ò–Ω–≤–µ—Å—Ç –ë–ª–æ–≥–µ—Ä', niche:'–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏', geo:'–†–æ—Å—Å–∏—è', tg:'@investblog2', r:4.4, deals:6,
   tags:['–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏','–∞–∫—Ü–∏–∏','—Ñ–æ–Ω–¥—ã','—Ñ–∏–Ω–∞–Ω—Å—ã'],
   s:[
     {plat:'Telegram',link:'@investblog2',subs:30000,views:'16 000 –ø—Ä–æ—Å–º.',er:'5.2%',verified:true},
     {plat:'YouTube',link:'InvestBlog2',subs:50000,views:'24 000 –ø—Ä–æ—Å–º.',er:'4.1%',verified:true},
     {plat:'–Ø–Ω–¥–µ–∫—Å.–î–∑–µ–Ω',link:'zen.yandex.ru/investblog2',subs:12000,views:'5 000 –ø—Ä–æ—Å–º.',er:'1.8%',verified:false}
   ],
   p:[{n:'–ü–æ—Å—Ç –≤ Telegram',d:'–ù–∞—Ç–∏–≤–Ω—ã–π –ø–æ—Å—Ç —Å —Å—Å—ã–ª–∫–æ–π',p:20000,plat:'Telegram'},
      {n:'–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ YouTube',d:'–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è 60-90 —Å–µ–∫',p:40000,plat:'YouTube'},
      {n:'–°—Ç–∞—Ç—å—è –≤ –Ø–Ω–¥–µ–∫—Å.–î–∑–µ–Ω',d:'–õ–æ–Ω–≥—Ä–∏–¥ —Å —Å—Å—ã–ª–∫–∞–º–∏ ¬∑ 30 –¥–Ω–µ–π –≤ –ª–µ–Ω—Ç–µ',p:15000,plat:'–Ø–Ω–¥–µ–∫—Å.–î–∑–µ–Ω'},
      {n:'–°–ø–µ—Ü–ø—Ä–æ–µ–∫—Ç',d:'–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è ‚Äî –æ–≥–æ–≤–∞—Ä–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ',p:0,plat:'*'}]},
  {id:3, n:'DeFi Expert', niche:'DeFi', geo:'–†–æ—Å—Å–∏—è', tg:'@defiexpert3', r:4.5, deals:9,
   tags:['DeFi','Web3','NFT','–±–ª–æ–∫—á–µ–π–Ω','–∫—Ä–∏–ø—Ç–æ'],
   s:[
     {plat:'Telegram',link:'@defiexpert3',subs:45000,views:'24 000 –ø—Ä–æ—Å–º.',er:'5.8%',verified:true},
     {plat:'YouTube',link:'DeFiExpert3',subs:75000,views:'36 000 –ø—Ä–æ—Å–º.',er:'4.5%',verified:true},
     {plat:'Twitter/X',link:'@defiexpert3',subs:22000,views:'18 000 –ø—Ä–æ—Å–º.',er:'3.2%',verified:false}
   ],
   p:[{n:'–ü–æ—Å—Ç –≤ Telegram',d:'–ù–∞—Ç–∏–≤–Ω—ã–π –ø–æ—Å—Ç —Å —Å—Å—ã–ª–∫–æ–π',p:30000,plat:'Telegram'},
      {n:'–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ YouTube',d:'–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è 60-90 —Å–µ–∫',p:60000,plat:'YouTube'},
      {n:'–¢—Ä–µ–¥ –≤ Twitter/X',d:'–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç—Ä–µ–¥ —Å —Å—Å—ã–ª–∫–æ–π',p:18000,plat:'Twitter/X'},
      {n:'–°–ø–µ—Ü–ø—Ä–æ–µ–∫—Ç',d:'–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è ‚Äî –æ–≥–æ–≤–∞—Ä–∏–≤–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ',p:0,plat:'*'}]}
];

const ALL_TAGS = ['–∫—Ä–∏–ø—Ç–æ','–±–∏—Ä–∂–∏','DeFi','–æ–±–∑–æ—Ä—ã','–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏','–∞–∫—Ü–∏–∏','—Ñ–æ–Ω–¥—ã','NFT','Web3','—Ç—Ä–µ–π–¥–∏–Ω–≥','—Ñ–∏–Ω–∞–Ω—Å—ã','–±–ª–æ–∫—á–µ–π–Ω','—Å—Ç–µ–π–∫–∏–Ω–≥','P2P'];

// –ö–∞–º–ø–∞–Ω–∏–∏ ‚Äî —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –ø–æ —ç–º–∏—Ç–µ–Ω—Ç–∞–º
const CAMPAIGNS = {
  issuer: [
    {id:1, title:'BingX ‚Äî –û—Å–µ–Ω–Ω–∏–π –Ω–∞–±–æ—Ä –±–ª–æ–≥–µ—Ä–æ–≤', desc:'–ò—â–µ–º 10 –∫—Ä–∏–ø—Ç–æ-–±–ª–æ–≥–µ—Ä–æ–≤ –¥–ª—è –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏—è BingX Exchange. –†–∞—Å—Å–∫–∞–∑–∞—Ç—å –ø—Ä–æ —Ç–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã, –∫–µ—à–±—ç–∫, —Ä–µ—Ñ. –ø—Ä–æ–≥—Ä–∞–º–º—É. –°—Å—ã–ª–∫–∞ —Å UTM.', niche:'–∫—Ä–∏–ø—Ç–æ', budget:25000, count:10, deadline:'20 –º–∞—Ä 2026', platform:'Telegram', status:'ACTIVE', applies:10},
    {id:2, title:'BingX ‚Äî YouTube-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏', desc:'–ù—É–∂–Ω—ã 5 YouTube-–±–ª–æ–≥–µ—Ä–æ–≤ —Å –∞—É–¥–∏—Ç–æ—Ä–∏–µ–π 20K+ –¥–ª—è –æ–±–∑–æ—Ä–∞ —Ñ—É–Ω–∫—Ü–∏–∏ Copy Trading.', niche:'–∫—Ä–∏–ø—Ç–æ', budget:60000, count:5, deadline:'15 –∞–ø—Ä 2026', platform:'YouTube', status:'DRAFT', applies:0}
  ],
  issuer2: []
};

// –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ ‚Äî –º—É—Ç–∞–±–µ–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
const VERIFICATIONS = {
  issuer2: {name:'InvestFund Alpha', email:'issuer2@test.ru', type:'FUND', date:'22 —Ñ–µ–≤ 2026', status:'pending'}
};

const ACCS = {
  issuer:  {role:'ISSUER',  email:'issuer1@test.ru',  name:'BingX Exchange',   verified:true,  type:'CRYPTO_EXCHANGE', site:'https://bingx.com', sub:'BASE', r:4.7, deals:18},
  issuer2: {role:'ISSUER',  email:'issuer2@test.ru',  name:'InvestFund Alpha', verified:false, type:'FUND', site:'https://investfund.ru', sub:'BASE', r:0, deals:0},
  blogger: {role:'BLOGGER', email:'blogger1@test.ru', name:'–ö—Ä–∏–ø—Ç–æ –ë–ª–æ–≥–µ—Ä 1'},
  admin:   {role:'ADMIN',   email:'admin@adexchange.ru', name:'–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä'}
};

const USERS_LIST = [
  {email:'admin@adexchange.ru', role:'ADMIN', status:'active', name:'–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', date:'01 —è–Ω–≤ 2026', banned:false},
  {email:'issuer1@test.ru', role:'ISSUER', status:'verified', name:'BingX Exchange', date:'10 —è–Ω–≤ 2026', banned:false},
  {email:'issuer2@test.ru', role:'ISSUER', status:'pending', name:'InvestFund Alpha', date:'22 —Ñ–µ–≤ 2026', banned:false},
  {email:'blogger1@test.ru', role:'BLOGGER', status:'active', name:'–ö—Ä–∏–ø—Ç–æ –ë–ª–æ–≥–µ—Ä 1', date:'15 —è–Ω–≤ 2026', banned:false},
  {email:'blogger2@test.ru', role:'BLOGGER', status:'active', name:'–ò–Ω–≤–µ—Å—Ç –ë–ª–æ–≥–µ—Ä', date:'16 —è–Ω–≤ 2026', banned:false},
  {email:'blogger3@test.ru', role:'BLOGGER', status:'active', name:'DeFi Expert', date:'17 —è–Ω–≤ 2026', banned:false}
];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DISPUTES DATA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const DISPUTES = [
  {id:1, issuer:'BingX Exchange', issuerEmail:'issuer1@test.ru',
   blogger:'–ö—Ä–∏–ø—Ç–æ –ë–ª–æ–≥–µ—Ä 1', bloggerEmail:'blogger1@test.ru',
   amount:10000, total:11000,
   reason:'–ë–ª–æ–≥–µ—Ä –Ω–µ —Ä–∞–∑–º–µ—Å—Ç–∏–ª –ø–æ—Å—Ç –≤ —Å—Ä–æ–∫. –î–µ–¥–ª–∞–π–Ω 1 –º–∞—Ä—Ç–∞, –ø–æ—Å—Ç –¥–æ —Å–∏—Ö –ø–æ—Ä –Ω–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω.',
   status:'open', date:'3 –º–∞—Ä 2026',
   msgs:[
     {from:'issuer', text:'–û—Ç–∫—Ä—ã–≤–∞—é —Å–ø–æ—Ä ‚Äî –ø–æ—Å—Ç –Ω–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω –≤ —Å—Ä–æ–∫, –¥–µ–¥–ª–∞–π–Ω –ø—Ä–æ—à—ë–ª.', time:'3 –º–∞—Ä, 10:15'},
     {from:'blogger', text:'–ü—Ä–æ—à—É –ø—Ä–æ—â–µ–Ω–∏—è, –±—ã–ª–∞ –∑–∞–¥–µ—Ä–∂–∫–∞. –ì–æ—Ç–æ–≤ –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å–µ–≥–æ–¥–Ω—è.', time:'3 –º–∞—Ä, 11:02'},
     {from:'admin', text:'–ü—Ä–∏–Ω—è—Ç–æ –∫ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—é. –û–∂–∏–¥–∞–π—Ç–µ —Ä–µ—à–µ–Ω–∏—è –≤ —Ç–µ—á–µ–Ω–∏–µ 48 —á–∞—Å–æ–≤.', time:'3 –º–∞—Ä, 11:30'}
   ]},
  {id:2, issuer:'BingX Exchange', issuerEmail:'issuer1@test.ru',
   blogger:'DeFi Expert', bloggerEmail:'blogger3@test.ru',
   amount:30000, total:33000,
   reason:'–ù–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ: –Ω–µ —É–ø–æ–º—è–Ω—É—Ç—ã –∫–ª—é—á–µ–≤—ã–µ —Ç–µ–∑–∏—Å—ã –∏–∑ –¢–ó, –Ω–µ—Ç UTM-—Å—Å—ã–ª–∫–∏.',
   status:'open', date:'1 –º–∞—Ä 2026',
   msgs:[
     {from:'issuer', text:'–ü–æ—Å—Ç –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω, –Ω–æ UTM-—Å—Å—ã–ª–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏ –Ω–µ —É–ø–æ–º—è–Ω—É—Ç –∫–µ—à–±—ç–∫.', time:'1 –º–∞—Ä, 14:00'},
     {from:'blogger', text:'–ò—Å–ø—Ä–∞–≤–ª—é –ø–æ—Å—Ç, –¥–æ–±–∞–≤–ª—é —Å—Å—ã–ª–∫—É. –ü—Ä–æ—à—É –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —ç—Å–∫—Ä–æ—É.', time:'1 –º–∞—Ä, 15:20'},
     {from:'admin', text:'–†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –æ–±–æ–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤.', time:'1 –º–∞—Ä, 16:00'}
   ]}
];

// –¢–µ–≥–∏ –±–ª–æ–≥–µ—Ä–∞ (–º—É—Ç–∞–±–µ–ª—å–Ω—ã–µ)
let bloggerTags = ['–∫—Ä–∏–ø—Ç–æ','–±–∏—Ä–∂–∏','DeFi','–æ–±–∑–æ—Ä—ã'];

// –°–æ—Ü—Å–µ—Ç–∏ –∏ –ø—Ä–∞–π—Å –±–ª–æ–≥–µ—Ä–∞ (–º—É—Ç–∞–±–µ–ª—å–Ω—ã–µ)
let bloggerSocials = [...BLOGGERS[0].s];
let bloggerPrices = [...BLOGGERS[0].p];

let CU = null, CB = null; // Current User, Current Blogger

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// NAV & LOGIN
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function quickLogin(type) {
  const a = ACCS[type]; if (!a) return;
  CU = {...a, accKey: type};
  updateNav();
  if (a.role === 'ISSUER') {
    renderIssuerDashboard();
    showPage('issuer');
    iTab('dashboard', document.querySelector('#page-issuer .si'));
  } else if (a.role === 'BLOGGER') {
    document.getElementById('bTitle').textContent = '–ü–∞–Ω–µ–ª—å –±–ª–æ–≥–µ—Ä–∞';
    document.getElementById('bName').textContent = a.name;
    document.getElementById('bAvatar').textContent = a.name[0];
    renderProfileTags();
    renderSocials();
    renderPrices();
    renderBloggerCampaigns();
    showPage('blogger');
    bTab('dashboard', document.querySelector('#page-blogger .si'));
  } else {
    renderAdmin();
    showPage('admin');
    aTab('dashboard', document.querySelector('#page-admin .si'));
  }
}

function doLogin() {
  const e = document.getElementById('loginEmail').value;
  const m = {'issuer1@test.ru':'issuer','issuer2@test.ru':'issuer2','blogger1@test.ru':'blogger','admin@adexchange.ru':'admin'};
  if (m[e]) quickLogin(m[e]); else showToast('–ê–∫–∫–∞—É–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω', 1);
}

function logout() { CU = null; updateNav(); showPage('landing'); }

function updateNav() {
  const nr = document.getElementById('navRight');
  nr.innerHTML = CU
    ? `<span class="nav-user">${CU.email}</span><button class="btn btn-secondary btn-sm" onclick="logout()">–í—ã–π—Ç–∏</button>`
    : `<button class="btn btn-secondary btn-sm" onclick="showPage('login')">–í–æ–π—Ç–∏</button><button class="btn btn-primary btn-sm" onclick="showPage('login')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>`;
}

function showPage(n) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  const p = document.getElementById('page-' + n); if (p) p.classList.add('active');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TAB SWITCHES
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function iTab(t, el) {
  if ((t === 'catalog' || t === 'deals') && CU && !CU.verified) {
    showToast('üîí –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∞–∫–∫–∞—É–Ω—Ç–∞–º. –û–∂–∏–¥–∞–π—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.', 1);
    return;
  }
  document.querySelectorAll('#page-issuer .tc').forEach(x => x.classList.remove('active'));
  document.querySelectorAll('#page-issuer .si').forEach(x => x.classList.remove('active'));
  const tc = document.getElementById('i-' + t); if (tc) tc.classList.add('active');
  if (el) el.classList.add('active');
  if (t === 'catalog') renderCatalog();
  if (t === 'campaigns') renderIssuerCampaigns();
  if (t === 'deals') renderIssuerDeals();
}
function bTab(t, el) {
  document.querySelectorAll('#page-blogger .tc').forEach(x => x.classList.remove('active'));
  document.querySelectorAll('#page-blogger .si').forEach(x => x.classList.remove('active'));
  const tc = document.getElementById('b-' + t); if (tc) tc.classList.add('active');
  if (el) el.classList.add('active');
  if (t === 'profile') {
    // bTab clears ALL .tc inside #page-blogger (including nested sub-tabs),
    // so restore the default sub-tab pt-basic as active
    const defSub = document.getElementById('pt-basic');
    if (defSub) defSub.classList.add('active');
    const defSubBtn = document.querySelector('#b-profile .tab');
    if (defSubBtn) defSubBtn.classList.add('active');
    renderProfileTags(); renderSocials(); renderPrices();
  }
}
function aTab(t, el) {
  document.querySelectorAll('#page-admin .tc').forEach(x => x.classList.remove('active'));
  document.querySelectorAll('#page-admin .si').forEach(x => x.classList.remove('active'));
  const tc = document.getElementById('a-' + t); if (tc) tc.classList.add('active');
  if (el) el.classList.add('active');
  if (t === 'dashboard') setTimeout(drawCharts, 60);
  if (t === 'verify') renderVerifyTab();
  if (t === 'users') renderUsersTab();
  if (t === 'disputes') renderDisputesTab();
  if (t === 'commissions') renderCommissionsTab();
  if (t === 'tags') renderAdminTagsTab();
}
function pTab(t, el) {
  document.querySelectorAll('#b-profile .tc').forEach(x => x.classList.remove('active'));
  document.querySelectorAll('#b-profile .tab').forEach(x => x.classList.remove('active'));
  const tc = document.getElementById('pt-' + t); if (tc) tc.classList.add('active');
  if (el) el.classList.add('active');
  if (t === 'basic')   renderProfileTags();
  if (t === 'socials') renderSocials();
  if (t === 'prices')  renderPrices();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ISSUER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderIssuerDashboard() {
  const v = CU.verified;
  document.getElementById('iTitle').textContent = '–ü–∞–Ω–µ–ª—å —ç–º–∏—Ç–µ–Ω—Ç–∞';
  document.getElementById('iSub').textContent = CU.name;
  document.getElementById('issuerBanner').style.display = v ? 'none' : 'flex';
  document.getElementById('iStatTier').textContent = CU.sub || 'BASE';
  document.getElementById('iStatStatus').textContent = v ? '‚úì –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω' : '‚è≥ –ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ';
  const camps = CAMPAIGNS[CU.accKey] || [];
  const activeCamps = camps.filter(c => c.status === 'ACTIVE');
  document.getElementById('iStatCamp').textContent = activeCamps.length;
  document.getElementById('iStatBudget').textContent = '‚ÇΩ' + activeCamps.reduce((s, c) => s + c.budget * c.count, 0).toLocaleString('ru');
  // Dash campaigns
  const dc = document.getElementById('iDashCampaigns');
  if (camps.length === 0) dc.innerHTML = '<div class="es"><div class="es-icon">üì¢</div>–ö–∞–º–ø–∞–Ω–∏–π –Ω–µ—Ç</div>';
  else dc.innerHTML = camps.map(c => `
    <div class="cc">
      <div class="cc-title">${c.title}</div>
      <div class="cc-desc">${c.desc.substring(0, 80)}...</div>
      <div style="display:flex;gap:6px"><span class="b ${c.status==='ACTIVE'?'g':'gr'}">${c.status}</span><span class="b in">‚ÇΩ${c.budget.toLocaleString('ru')}</span><span class="b gr">${c.applies} –æ—Ç–∫–ª–∏–∫–æ–≤</span></div>
    </div>`).join('');
  document.getElementById('iDashDeals').innerHTML = '<div class="es"><div class="es-icon">üìã</div>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–¥–µ–ª–æ–∫</div>';
  renderIProfile();
}

function tryCreateCampaign() {
  if (!CU.verified) {
    showToast('‚ùå –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–π –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∞–∫–∫–∞—É–Ω—Ç–∞–º', 1);
    return;
  }
  openModal('mCampaign');
}

function createCampaign() {
  const name = document.getElementById('campName').value.trim();
  const desc = document.getElementById('campDesc').value.trim();
  const budget = parseInt(document.getElementById('campBudget').value) || 0;
  if (!name || !desc || !budget) { showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 1); return; }
  const newC = {
    id: Date.now(), title: name, desc: desc,
    niche: document.getElementById('campNiche').value,
    budget: budget,
    count: parseInt(document.getElementById('campCount').value) || 5,
    deadline: document.getElementById('campDeadline').value || '01 –∞–ø—Ä 2026',
    platform: document.getElementById('campPlatform').value,
    status: 'ACTIVE', applies: 0
  };
  if (!CAMPAIGNS[CU.accKey]) CAMPAIGNS[CU.accKey] = [];
  CAMPAIGNS[CU.accKey].push(newC);
  closeModal('mCampaign');
  showToast('‚úì –ö–∞–º–ø–∞–Ω–∏—è —Å–æ–∑–¥–∞–Ω–∞!');
  renderIssuerDashboard();
  iTab('campaigns', null);
  document.querySelectorAll('#page-issuer .si').forEach((el, i) => { if (i === 2) el.classList.add('active'); else el.classList.remove('active'); });
}

function renderIssuerCampaigns() {
  const camps = CAMPAIGNS[CU?.accKey] || [];
  const el = document.getElementById('iCampaignsList');
  if (camps.length === 0) { el.innerHTML = '<div class="es"><div class="es-icon">üì¢</div>–ö–∞–º–ø–∞–Ω–∏–π –Ω–µ—Ç. –°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é!</div>'; return; }
  el.innerHTML = camps.map(c => `
    <div class="cc" style="cursor:pointer" onclick="openCampaignDetail(${c.id})">
      <div style="display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:8px">
        <div><div class="cc-title">${c.title}</div><span class="b ${c.status==='ACTIVE'?'g':'gr'}">${c.status}</span>&nbsp;<span class="b pu">${c.applies} –æ—Ç–∫–ª–∏–∫–æ–≤</span></div>
        <button class="btn btn-secondary btn-sm" onclick="event.stopPropagation();editCampaign(${c.id})">‚úèÔ∏è –†–µ–¥.</button>
      </div>
      <div class="cc-desc">${c.desc}</div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <span class="b in">üí∞ ‚ÇΩ${c.budget.toLocaleString('ru')}</span>
        <span class="b gr">üë• –ù—É–∂–Ω–æ: ${c.count}</span>
        <span class="b gr">üìÖ ${c.deadline}</span>
        <span class="pl">${c.platform}</span>
        <span class="pl">${c.niche}</span>
      </div>
    </div>`).join('');
}

function openCampaignDetail(id) {
  const camps = CAMPAIGNS[CU?.accKey] || [];
  const c = camps.find(x => x.id === id); if (!c) return;
  document.getElementById('mCampDetailTitle').textContent = c.title;
  document.getElementById('mCampDetailBody').innerHTML = `
    <div class="sc-grid" style="grid-template-columns:repeat(3,1fr);margin-bottom:16px">
      <div class="sc c1"><div class="v">${c.applies}</div><div class="l">–û—Ç–∫–ª–∏–∫–æ–≤</div></div>
      <div class="sc c2"><div class="v">‚ÇΩ${c.budget.toLocaleString('ru')}</div><div class="l">–ë—é–¥–∂–µ—Ç/–±–ª–æ–≥–µ—Ä</div></div>
      <div class="sc c4"><div class="v">${c.count}</div><div class="l">–ù—É–∂–Ω–æ –±–ª–æ–≥–µ—Ä–æ–≤</div></div>
    </div>
    <div class="fg"><label class="fl">–û–ø–∏—Å–∞–Ω–∏–µ</label><div style="font-size:14px;color:#555;line-height:1.6;padding:10px 14px;background:#f9f9fc;border-radius:8px">${c.desc}</div></div>
    <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:16px">
      <span class="b ${c.status==='ACTIVE'?'g':'gr'}">${c.status}</span>
      <span class="pl">${c.platform}</span><span class="pl">${c.niche}</span>
      <span class="b gr">üìÖ –¥–æ ${c.deadline}</span>
    </div>
    <div style="display:flex;gap:8px">
      <button class="btn btn-primary btn-sm" onclick="editCampaign(${c.id});closeModal('mCampDetail')">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
      <button class="btn btn-danger btn-sm" onclick="showToast('–ö–∞–º–ø–∞–Ω–∏—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞');closeModal('mCampDetail')">‚è∏ –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
      <button class="btn btn-success btn-sm" onclick="completeCampaign(${c.id});closeModal('mCampDetail')">‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å –∫–∞–º–ø–∞–Ω–∏—é</button>
      <button class="btn btn-secondary btn-sm" onclick="closeModal('mCampDetail')">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>`;
  openModal('mCampDetail');
}

function completeCampaign(id) {
  const camps = CAMPAIGNS[CU?.accKey] || [];
  const c = camps.find(x => x.id === id); if (!c) return;
  c.status = 'COMPLETED';
  showToast('‚úÖ –ö–∞–º–ø–∞–Ω–∏—è ¬´' + c.title + '¬ª –∑–∞–≤–µ—Ä—à–µ–Ω–∞');
  renderIssuerCampaigns();
}

function editCampaign(id) {
  const camps = CAMPAIGNS[CU?.accKey] || [];
  const c = camps.find(x => x.id === id); if (!c) return;
  document.getElementById('campName').value = c.title;
  document.getElementById('campDesc').value = c.desc;
  document.getElementById('campBudget').value = c.budget;
  document.getElementById('campCount').value = c.count;
  openModal('mCampaign');
}

function renderIssuerDeals() {
  document.getElementById('iDealsList').innerHTML = `
    <div class="deal-card">
      <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:12px">
        <div>
          <div style="font-size:16px;font-weight:800">–ö—Ä–∏–ø—Ç–æ –ë–ª–æ–≥–µ—Ä 1 ‚Üí Telegram –ø–æ—Å—Ç</div>
          <div style="font-size:12px;color:#888;margin-top:3px">–°–æ–∑–¥–∞–Ω–∞: 20 —Ñ–µ–≤ 2026 ¬∑ –î–µ–¥–ª–∞–π–Ω: 1 –º–∞—Ä 2026</div>
        </div>
        <span class="b y">–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏</span>
      </div>
      <div style="background:#f0f4ff;border-radius:8px;padding:10px 14px;margin-bottom:12px;font-size:13px">
        <div style="display:flex;justify-content:space-between"><span>–ì–æ–Ω–æ—Ä–∞—Ä –±–ª–æ–≥–µ—Ä–∞:</span><span style="font-weight:700">‚ÇΩ10 000</span></div>
        <div style="display:flex;justify-content:space-between;color:#888;margin-top:3px"><span>–ö–æ–º–∏—Å—Å–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã (+10%, –º–∏–Ω.):</span><span>‚ÇΩ1 000</span></div>
        <div style="display:flex;justify-content:space-between;font-weight:800;color:#6366f1;margin-top:6px;padding-top:6px;border-top:1px solid #e0e0f8"><span>–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ:</span><span>‚ÇΩ11 000</span></div>
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <button class="btn btn-success btn-sm" onclick="showToast('‚úì –†–∞–∑–º–µ—â–µ–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ! –°—Ä–µ–¥—Å—Ç–≤–∞ –≤—ã–ø–ª–∞—á–µ–Ω—ã.')">‚úì –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ</button>
        <button class="btn btn-danger btn-sm" style="margin-left:auto" onclick="openDisputeModal(1)">‚ö†Ô∏è –û—Ç–∫—Ä—ã—Ç—å —Å–ø–æ—Ä</button>
      </div>
    </div>
    <div class="es" style="padding:20px"><div class="es-icon">ü§ù</div><div>–ë–æ–ª—å—à–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ –Ω–µ—Ç</div><button class="btn btn-primary btn-sm" style="margin-top:14px" onclick="iTab('catalog', document.querySelectorAll('#page-issuer .si')[1])">–ù–∞–π—Ç–∏ –±–ª–æ–≥–µ—Ä–æ–≤</button></div>`;
}

function renderIProfile() {
  if (!CU) return;
  document.getElementById('iProfileCard').innerHTML = `
    <div style="display:flex;align-items:center;gap:20px;margin-bottom:20px">
      <div style="position:relative;cursor:pointer" onclick="document.getElementById('iAvatarInput').click()" title="–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –ª–æ–≥–æ—Ç–∏–ø–∞">
        <div class="pa" id="iProfileAvatar">${CU.name[0]}</div>
        <div style="position:absolute;bottom:-4px;right:-4px;width:22px;height:22px;background:#6366f1;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-size:12px;border:2px solid #fff">‚úèÔ∏è</div>
      </div>
      <input type="file" id="iAvatarInput" accept="image/*" style="display:none" onchange="previewIssuerAvatar(this)">
      <div>
        <div class="pn">${CU.name}</div>
        <div class="ps">${CU.email}</div>
        <div class="pb">${CU.verified ? '<span class="b g">‚úì –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω</span>' : '<span class="b y">‚è≥ –ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</span>'}<span class="b in">${CU.type||'ISSUER'}</span></div>
      </div>
    </div>
    <div class="fr"><div class="fg"><label class="fl">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏</label><input class="fi" value="${CU.name}"></div><div class="fg"><label class="fl">–°–∞–π—Ç</label><input class="fi" value="${CU.site||''}"></div></div>
    <div class="fg"><label class="fl">–û–ø–∏—Å–∞–Ω–∏–µ</label><textarea class="fi" rows="2" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏..."></textarea></div>
    <button class="btn btn-primary" onclick="showToast('–ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω!')">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>`;
}

function activatePro() {
  showToast('üí≥ –ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ–ø–ª–∞—Ç–µ... (–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–ª–∞—Ç—ë–∂–∫–∏ –≤ production-–≤–µ—Ä—Å–∏–∏)');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CATALOG
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderCatalog() {
  const nf = document.getElementById('catFilterNiche')?.value || '';
  const pf = document.getElementById('catFilterPlat')?.value || '';
  const sort = document.getElementById('catSort')?.value || 'rating';
  let list = [...BLOGGERS];
  if (nf) list = list.filter(b => b.niche.toLowerCase().includes(nf.toLowerCase()));
  if (pf) list = list.filter(b => b.s.some(s => s.plat === pf));
  if (sort === 'rating') list.sort((a,b) => b.r - a.r);
  else if (sort === 'price_asc') list.sort((a,b) => Math.min(...a.p.map(p=>p.p)) - Math.min(...b.p.map(p=>p.p)));
  else if (sort === 'price_desc') list.sort((a,b) => Math.min(...b.p.map(p=>p.p)) - Math.min(...a.p.map(p=>p.p)));
  else if (sort === 'subs') list.sort((a,b) => Math.max(...b.s.map(s=>s.subs)) - Math.max(...a.s.map(s=>s.subs)));
  const g = document.getElementById('catalogGrid');
  const empty = document.getElementById('catalogEmpty');
  if (list.length === 0) { g.innerHTML = ''; empty.style.display = 'block'; return; }
  empty.style.display = 'none';
  g.innerHTML = list.map(b => `
    <div class="bc" onclick="openBlogger(${b.id})">
      <div style="display:flex;align-items:flex-start;justify-content:space-between">
        <div class="bc-av">${b.n[0]}</div>
        <div style="font-size:16px;font-weight:800;color:#ca8a04">‚òÖ ${b.r}</div>
      </div>
      <div style="display:flex;align-items:baseline;justify-content:space-between;margin-bottom:2px">
        <div style="font-size:16px;font-weight:700">${b.n}</div>
        <span class="b gr" style="font-size:11px">‚úÖ ${b.deals} —Å–¥–µ–ª–æ–∫</span>
      </div>
      <div style="font-size:12px;color:#888;margin-bottom:8px">${b.niche} ¬∑ ${b.geo}</div>
      <div style="margin-bottom:8px">${b.s.map(s=>`<div style="font-size:12px;color:#666;margin-bottom:2px">${PLATFORM_ICONS[s.plat]||'üì°'} ${s.plat}: ${(s.subs/1000).toFixed(0)}K –ø–æ–¥–ø.</div>`).join('')}</div>
      <div style="margin-bottom:10px">${b.tags.slice(0,3).map(t=>`<span class="pl">${t}</span>`).join('')}</div>
      <div style="background:#eef2ff;color:#6366f1;border-radius:8px;padding:6px 10px;font-size:13px;font-weight:700;display:inline-block;margin-bottom:10px">–æ—Ç ‚ÇΩ${Math.min(...b.p.map(p=>p.p)).toLocaleString('ru')}</div>
      <button class="btn btn-primary" style="width:100%">–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å —Å–¥–µ–ª–∫—É</button>
    </div>`).join('');
}

function openBlogger(id) {
  const b = BLOGGERS.find(x => x.id === id); if (!b) return;
  CB = b;
  document.getElementById('mBName').textContent = b.n;
  document.getElementById('mBSub').textContent = b.niche + ' ¬∑ ' + b.geo + ' ¬∑ ' + b.tg + ' ¬∑ ‚òÖ ' + b.r;
  document.getElementById('mBBody').innerHTML = `
    <div class="g2" style="margin-bottom:16px">
      ${b.s.map(s=>`<div class="soc"><div class="soc-icon">${PLATFORM_ICONS[s.plat]||'üì°'}</div><div><div style="font-size:13px;font-weight:700">${s.plat}</div><div style="font-size:12px;color:#888">${(s.subs/1000).toFixed(0)}K –ø–æ–¥–ø. ¬∑ ${s.views} ¬∑ ER ${s.er}${s.verified?' ¬∑ <span style="color:#16a34a">‚úì</span>':''}</div></div></div>`).join('')}
    </div>
    <div style="margin-bottom:16px">
      <div style="font-size:14px;font-weight:700;margin-bottom:8px">–¢–µ–≥–∏</div>
      ${b.tags.map(t=>`<span class="tag active" style="cursor:default">${t}</span>`).join(' ')}
    </div>
    <div>
      <div style="font-size:14px;font-weight:700;margin-bottom:10px">–ü—Ä–∞–π—Å-–ª–∏—Å—Ç</div>
      ${b.p.map((p,si)=>{const rate=CUSTOM_COMMISSIONS['b'+b.id+'_s'+si]??CUSTOM_COMMISSIONS[b.id]??COMMISSION;const comm=Math.round(p.p*rate);const total=p.p+comm;const pct=Math.round(rate*100);return`<div class="pli"><div><div class="pli-n">${p.n}</div><div class="pli-d">${p.d}</div></div><div style="text-align:right"><div class="pli-p">‚ÇΩ${p.p.toLocaleString('ru')}</div><div style="font-size:11px;color:#888">+‚ÇΩ${comm.toLocaleString('ru')} –∫–æ–º–∏—Å—Å–∏—è (${pct}%)</div><div style="font-size:12px;font-weight:700;color:#6366f1">= ‚ÇΩ${total.toLocaleString('ru')} –∏—Ç–æ–≥–æ</div></div></div>`}).join('')}
    </div>`;
  openModal('mBlogger');
}

function openDealModal() {
  if (!CB) return;
  document.getElementById('mDealFor').textContent = '‚Üí ' + CB.n;
  // Populate social select first
  const ss = document.getElementById('dealSocial');
  ss.innerHTML = '<option value="">‚Äî –≤—ã–±–µ—Ä–∏—Ç–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É ‚Äî</option>' + CB.s.map(s=>`<option value="${s.plat}">${PLATFORM_ICONS[s.plat]||''} ${s.plat} (${(s.subs/1000).toFixed(0)}K –ø–æ–¥–ø.)</option>`).join('');
  // Show all formats initially (filtered after platform picked)
  filterDealFormats('');
  document.getElementById('dealAmt').value = '';
  document.getElementById('commBox').style.display = 'none';
  const sph = document.getElementById('specProjHint'); if (sph) sph.style.display = 'none';
  document.getElementById('dealTZ').value = '';
  CB_SI = null;
  openModal('mDeal');
}

function filterDealFormats(plat) {
  if (!CB) return;
  const fs = document.getElementById('dealFormat');
  const filtered = CB.p.filter((p,si) => !plat || p.plat === plat || p.plat === '*');
  if (filtered.length === 0) {
    fs.innerHTML = '<option value="">‚Äî –Ω–µ—Ç —Ñ–æ—Ä–º–∞—Ç–æ–≤ –¥–ª—è —ç—Ç–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã ‚Äî</option>';
    return;
  }
  fs.innerHTML = '<option value="">‚Äî –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç ‚Äî</option>' + filtered.map(p => {
    const si = CB.p.indexOf(p);
    const price = p.p > 0 ? '‚ÇΩ' + p.p.toLocaleString('ru') : '–ø–æ –∑–∞–ø—Ä–æ—Å—É';
    return `<option value="${p.p}" data-si="${si}">${p.n} ‚Äî ${price}</option>`;
  }).join('');
  document.getElementById('dealAmt').value = '';
  document.getElementById('commBox').style.display = 'none';
  CB_SI = null;
}

let CB_SI = null; // Current blogger service index for commission calc
function setDealFormat() {
  const sel = document.getElementById('dealFormat');
  const v = sel.value;
  const opt = sel.selectedOptions[0];
  CB_SI = parseInt(opt?.dataset?.si ?? '-1');
  const isSpec = opt?.text?.includes('–°–ø–µ—Ü–ø—Ä–æ–µ–∫—Ç') || false;
  const hint = document.getElementById('specProjHint');
  if (hint) hint.style.display = isSpec ? 'block' : 'none';
  if (v === '0' || v === '') {
    // –°–ø–µ—Ü–ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –ø—É—Å—Ç–æ–π ‚Äî –æ—á–∏—Å—Ç–∏—Ç—å —Å—É–º–º—É, –∂–¥–∞—Ç—å —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞
    document.getElementById('dealAmt').value = '';
    document.getElementById('commBox').style.display = 'none';
  } else {
    document.getElementById('dealAmt').value = v;
    calcComm();
  }
}

function sendDeal() {
  const amt = parseFloat(document.getElementById('dealAmt').value);
  const tz = document.getElementById('dealTZ').value.trim();
  const soc = document.getElementById('dealSocial').value;
  if (!amt || !tz || !soc) { showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ü—Å–µ—Ç—å', 1); return; }
  showToast('‚úì –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –±–ª–æ–≥–µ—Ä—É!');
  closeModal('mDeal');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// BLOGGER
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderProfileTags() {
  const w = document.getElementById('profileTags'); if (!w) return;
  w.innerHTML = ALL_TAGS.map(t => `<span class="tag ${bloggerTags.includes(t)?'active':''}" onclick="toggleTag('${t}',this)">${t}</span>`).join('');
}

function toggleTag(t, el) {
  if (bloggerTags.includes(t)) {
    bloggerTags = bloggerTags.filter(x => x !== t);
    el.classList.remove('active');
  } else if (bloggerTags.length < 8) {
    bloggerTags.push(t);
    el.classList.add('active');
  } else {
    showToast('–ú–∞–∫—Å–∏–º—É–º 8 —Ç–µ–≥–æ–≤', 1);
  }
}

function previewBloggerAvatar(input) {
  const file = input.files[0]; if (!file) return;
  const reader = new FileReader();
  reader.onload = e => {
    const av = document.getElementById('bAvatar');
    av.style.background = 'none';
    av.style.padding = '0';
    av.innerHTML = `<img src="${e.target.result}" style="width:100%;height:100%;object-fit:cover;border-radius:16px">`;
    showToast('‚úì –§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–æ!');
  };
  reader.readAsDataURL(file);
}

function previewIssuerAvatar(input) {
  const file = input.files[0]; if (!file) return;
  const reader = new FileReader();
  reader.onload = e => {
    const av = document.getElementById('iProfileAvatar');
    if (av) {
      av.style.background = 'none';
      av.style.padding = '0';
      av.innerHTML = `<img src="${e.target.result}" style="width:100%;height:100%;object-fit:cover;border-radius:16px">`;
    }
    showToast('‚úì –§–æ—Ç–æ –∫–æ–º–ø–∞–Ω–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–æ!');
  };
  reader.readAsDataURL(file);
}

function openDisputeModal(dealId) {
  const d = DISPUTES.find(x => x.id === dealId) || DISPUTES[0];
  document.getElementById('mOpenDisputeTitle').textContent = '–°–ø–æ—Ä: ' + (d ? d.blogger + ' ‚Üî ' + d.issuer : '–ù–æ–≤—ã–π —Å–ø–æ—Ä');
  document.getElementById('mOpenDisputeBody').innerHTML = `
    <div class="vb" style="margin-bottom:16px"><div class="vb-icon">‚ö†Ô∏è</div>
    <div><h4>–û—Ç–∫—Ä—ã—Ç–∏–µ —Å–ø–æ—Ä–∞</h4><p>–≠—Å–∫—Ä–æ—É-—Å—Ä–µ–¥—Å—Ç–≤–∞ –±—É–¥—É—Ç –∑–∞–º–æ—Ä–æ–∂–µ–Ω—ã –¥–æ —Ä–µ—à–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞. –û–±—ã—á–Ω–æ 2‚Äì3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è.</p></div></div>
    <div class="fg"><label class="fl">–ü—Ä–∏—á–∏–Ω–∞ —Å–ø–æ—Ä–∞ *</label>
    <select class="fi" id="disputeReason">
      <option>–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –≤ —Å—Ä–æ–∫</option><option>–ù–µ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ</option>
      <option>–ù–∞—Ä—É—à–µ–Ω–∏–µ –¢–ó</option><option>–û—Ç–∫–∞–∑ –æ—Ç —Å–¥–µ–ª–∫–∏</option><option>–î—Ä—É–≥–æ–µ</option>
    </select></div>
    <div class="fg"><label class="fl">–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ *</label>
    <textarea class="fi" rows="3" id="disputeDesc" placeholder="–û–ø–∏—à–∏—Ç–µ —Å–∏—Ç—É–∞—Ü–∏—é –ø–æ–¥—Ä–æ–±–Ω–æ..."></textarea></div>
    <div class="fg"><label class="fl">–ñ–µ–ª–∞–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ</label>
    <select class="fi"><option>–ü–æ–ª–Ω—ã–π –≤–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤</option><option>–ß–∞—Å—Ç–∏—á–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è</option><option>–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ</option></select></div>
    <button class="btn btn-danger" style="width:100%;padding:12px" onclick="submitDispute()">‚ö†Ô∏è –û—Ç–∫—Ä—ã—Ç—å —Å–ø–æ—Ä</button>`;
  openModal('mOpenDispute');
}

function submitDispute() {
  const desc = document.getElementById('disputeDesc')?.value.trim();
  if (!desc) { showToast('–û–ø–∏—à–∏—Ç–µ —Å–∏—Ç—É–∞—Ü–∏—é', 1); return; }
  showToast('‚ö†Ô∏è –°–ø–æ—Ä –æ—Ç–∫—Ä—ã—Ç! –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 48 —á–∞—Å–æ–≤.');
  closeModal('mOpenDispute');
}

function saveProfile() {
  const name = document.getElementById('bInputName').value;
  const niche = document.getElementById('bInputNiche').value;
  document.getElementById('bName').textContent = name;
  document.getElementById('bNicheGeo').textContent = niche + ' ¬∑ –†–æ—Å—Å–∏—è ¬∑ @cryptoblogger1';
  document.getElementById('bAvatar').textContent = name[0];
  showToast('‚úì –ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω!');
}

function renderSocials() {
  const el = document.getElementById('socialsList'); if (!el) return;
  el.innerHTML = bloggerSocials.map((s, i) => `
    <div class="soc">
      <div class="soc-icon">${PLATFORM_ICONS[s.plat]||'üì°'}</div>
      <div style="flex:1">
        <div style="font-size:14px;font-weight:600">${s.plat} ‚Äî ${s.link}</div>
        <div style="font-size:12px;color:#888">${(s.subs/1000).toFixed(0)}K –ø–æ–¥–ø. ¬∑ ${s.views} ¬∑ ER ${s.er}${s.verified?' ¬∑ <span style="color:#16a34a">‚úì –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω</span>':''}</div>
      </div>
      <button class="btn btn-danger btn-sm" onclick="removeSocial(${i})" style="flex-shrink:0">‚úï</button>
    </div>`).join('');
}

function addSocial() {
  const plat = document.getElementById('addSocPlatform').value;
  const link = document.getElementById('addSocLink').value.trim();
  const subs = parseInt(document.getElementById('addSocSubs').value) || 0;
  const views = document.getElementById('addSocViews').value.trim() || '‚Äî';
  if (!link) { showToast('–í–≤–µ–¥–∏—Ç–µ —Å—Å—ã–ª–∫—É', 1); return; }
  bloggerSocials.push({plat, link, subs, views, er:'‚Äî', verified:false});
  document.getElementById('addSocLink').value = '';
  document.getElementById('addSocSubs').value = '';
  document.getElementById('addSocViews').value = '';
  renderSocials();
  showToast(`‚úì ${plat} –¥–æ–±–∞–≤–ª–µ–Ω!`);
}

function removeSocial(i) {
  bloggerSocials.splice(i, 1);
  renderSocials();
  showToast('–°–æ—Ü—Å–µ—Ç—å —É–¥–∞–ª–µ–Ω–∞');
}

function renderPrices() {
  const el = document.getElementById('pricesList'); if (!el) return;
  el.innerHTML = bloggerPrices.map((p, i) => `
    <div class="pli">
      <div><div class="pli-n">${p.n}</div><div class="pli-d">${p.d}</div></div>
      <div style="display:flex;align-items:center;gap:8px">
        <div class="pli-p">${p.p > 0 ? '‚ÇΩ' + p.p.toLocaleString('ru') : '<span style="color:#6366f1;font-size:13px">–ø–æ –∑–∞–ø—Ä–æ—Å—É</span>'}</div>
        <button class="btn btn-danger btn-sm" onclick="removePrice(${i})">‚úï</button>
      </div>
    </div>`).join('');
}

function addPrice() {
  const name = document.getElementById('addPriceName').value.trim();
  const val = parseInt(document.getElementById('addPriceVal').value) || 0;
  const desc = document.getElementById('addPriceDesc').value.trim();
  if (!name || !val) { showToast('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∏ —Ü–µ–Ω—É', 1); return; }
  bloggerPrices.push({n: name, d: desc || '–§–æ—Ä–º–∞—Ç —Ä–∞–∑–º–µ—â–µ–Ω–∏—è', p: val});
  document.getElementById('addPriceName').value = '';
  document.getElementById('addPriceVal').value = '';
  document.getElementById('addPriceDesc').value = '';
  renderPrices();
  showToast('‚úì –§–æ—Ä–º–∞—Ç –¥–æ–±–∞–≤–ª–µ–Ω!');
}

function removePrice(i) {
  bloggerPrices.splice(i, 1);
  renderPrices();
}

function renderBloggerCampaigns() {
  const nf = document.getElementById('bCampFilterNiche')?.value || '';
  const pf = document.getElementById('bCampFilterPlat')?.value || '';
  const sort = document.getElementById('bCampSort')?.value || 'budget_desc';
  // –í—Å–µ –∫–∞–º–ø–∞–Ω–∏–∏ –≤—Å–µ—Ö —ç–º–∏—Ç–µ–Ω—Ç–æ–≤
  let all = Object.entries(CAMPAIGNS).flatMap(([key, camps]) =>
    camps.filter(c => c.status === 'ACTIVE').map(c => ({...c, issuerKey: key, issuerName: ACCS[key]?.name || key, issuerR: ACCS[key]?.r || 0, issuerDeals: ACCS[key]?.deals || 0}))
  );
  if (nf) all = all.filter(c => c.niche.toLowerCase().includes(nf.toLowerCase()));
  if (pf) all = all.filter(c => c.platform === pf || c.platform === '–õ—é–±–∞—è');
  if (sort === 'budget_desc') all.sort((a, b) => b.budget - a.budget);
  else if (sort === 'budget_asc') all.sort((a, b) => a.budget - b.budget);
  const el = document.getElementById('bCampaignsList');
  if (all.length === 0) { el.innerHTML = '<div class="es"><div class="es-icon">üì¢</div>–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–∞–º–ø–∞–Ω–∏–π –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º</div>'; return; }
  el.innerHTML = all.map(c => `
    <div class="cc">
      <div style="display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:8px">
        <div>
          <div class="cc-title">${c.title}</div>
          <div style="display:flex;align-items:center;gap:6px;flex-wrap:wrap;margin-top:4px">
            <span class="b g">ACTIVE</span>
            <span class="b in" style="font-size:11px">${c.issuerName}</span>
            ${c.issuerR > 0 ? `<span class="b" style="background:#fef9c3;color:#ca8a04;font-size:11px">‚òÖ ${c.issuerR}</span>` : ''}
            ${c.issuerDeals > 0 ? `<span class="b gr" style="font-size:11px">‚úÖ ${c.issuerDeals} —Å–¥–µ–ª–æ–∫</span>` : ''}
          </div>
        </div>
        <div style="text-align:right"><div style="font-size:22px;font-weight:800;color:#6366f1">‚ÇΩ${c.budget.toLocaleString('ru')}</div><div style="font-size:11px;color:#aaa">–∑–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ</div></div>
      </div>
      <div class="cc-desc">${c.desc}</div>
      <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:8px">
        <div><span class="pl">${c.platform}</span><span class="pl">${c.niche}</span><span class="b gr" style="margin:2px">üë• ${c.count} –º–µ—Å—Ç</span><span class="b gr" style="margin:2px">üìÖ –¥–æ ${c.deadline}</span></div>
        <button class="btn btn-primary btn-sm" onclick="openApplyModal(${c.id}, '${c.title.replace(/'/g,"\\'")}')">–û—Ç–∫–ª–∏–∫–Ω—É—Ç—å—Å—è</button>
      </div>
    </div>`).join('');
}

function filterApplyFormats(plat) {
  const fs = document.getElementById('applyFormat');
  const filtered = bloggerPrices.filter(p => !plat || !p.plat || p.plat === plat || p.plat === '*');
  fs.innerHTML = '<option value="">‚Äî –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ä–º–∞—Ç ‚Äî</option>' + filtered.map(p => {
    const price = p.p > 0 ? '‚ÇΩ' + p.p.toLocaleString('ru') : '–ø–æ –∑–∞–ø—Ä–æ—Å—É';
    return `<option value="${p.p}">${p.n} ‚Äî ${price}</option>`;
  }).join('');
}

function openApplyModal(campId, campTitle) {
  document.getElementById('mApplyFor').textContent = '‚Üí ' + campTitle;
  const ss = document.getElementById('applySocial');
  ss.innerHTML = '<option value="">‚Äî –≤—ã–±–µ—Ä–∏—Ç–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É ‚Äî</option>' + bloggerSocials.map(s=>`<option value="${s.plat}">${PLATFORM_ICONS[s.plat]||''} ${s.plat} (${(s.subs/1000).toFixed(0)}K –ø–æ–¥–ø.)</option>`).join('');
  filterApplyFormats('');
  document.getElementById('applyCover').value = '';
  openModal('mApply');
}

function submitApply() {
  const soc = document.getElementById('applySocial').value;
  const fmt = document.getElementById('applyFormat').value;
  if (!soc || !fmt) { showToast('–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ü—Å–µ—Ç—å –∏ —Ñ–æ—Ä–º–∞—Ç', 1); return; }
  showToast('‚úì –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –≠–º–∏—Ç–µ–Ω—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç –µ—ë.');
  closeModal('mApply');
}

let chatAttachments = [];

function attachChatFile(input) {
  const file = input.files[0]; if (!file) return;
  const ICONS = {doc:'üìÑ',docx:'üìÑ',pptx:'üìä',pdf:'üìï',xlsx:'üìó',png:'üñº',jpg:'üñº',jpeg:'üñº'};
  const ext = file.name.split('.').pop().toLowerCase();
  const icon = ICONS[ext] || 'üìé';
  chatAttachments.push({name: file.name, ext, icon});
  const chips = document.getElementById('chatAttachChips');
  chips.style.display = 'flex';
  chips.innerHTML = chatAttachments.map((f,i) => 
    `<span style="display:inline-flex;align-items:center;gap:4px;background:#eef2ff;color:#4338ca;border-radius:6px;padding:3px 8px;font-size:12px;font-weight:600">
      ${f.icon} ${f.name}
      <button onclick="removeChatAttach(${i})" style="background:none;border:none;cursor:pointer;color:#6366f1;font-size:14px;line-height:1;padding:0 2px">√ó</button>
    </span>`).join('');
  input.value = '';
}

function removeChatAttach(i) {
  chatAttachments.splice(i, 1);
  const chips = document.getElementById('chatAttachChips');
  if (chatAttachments.length === 0) { chips.style.display = 'none'; chips.innerHTML = ''; return; }
  chips.innerHTML = chatAttachments.map((f,idx) => 
    `<span style="display:inline-flex;align-items:center;gap:4px;background:#eef2ff;color:#4338ca;border-radius:6px;padding:3px 8px;font-size:12px;font-weight:600">
      ${f.icon} ${f.name}
      <button onclick="removeChatAttach(${idx})" style="background:none;border:none;cursor:pointer;color:#6366f1;font-size:14px;line-height:1;padding:0 2px">√ó</button>
    </span>`).join('');
}

function sendChatMsg() {
  const inp = document.getElementById('chatInput');
  const msgs = document.getElementById('dealChatMsgs');
  const msg = inp.value.trim();
  if (!msg && chatAttachments.length === 0) return;
  const d = new Date();
  const time = d.getHours() + ':' + String(d.getMinutes()).padStart(2,'0');
  let content = msg ? msg.replace(/</g,'&lt;').replace(/>/g,'&gt;') : '';
  if (chatAttachments.length > 0) {
    const fileHtml = chatAttachments.map(f =>
      `<div onclick="mockDownload('${f.name}')" style="display:inline-flex;align-items:center;gap:5px;background:rgba(255,255,255,.2);border-radius:6px;padding:4px 8px;margin-top:4px;cursor:pointer;font-size:12px;font-weight:600;border:1px solid rgba(255,255,255,.3)" title="–ù–∞–∂–º–∏—Ç–µ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è">üìé ${f.name}</div>`
    ).join('');
    content = (content ? content + '<br>' : '') + fileHtml;
    chatAttachments = [];
    const chips = document.getElementById('chatAttachChips');
    chips.style.display = 'none'; chips.innerHTML = '';
  }
  if (!content) return;
  msgs.innerHTML += `<div class="chat-msg out">${content}<div class="msg-time">${time}</div></div>`;
  msgs.scrollTop = msgs.scrollHeight;
  inp.value = '';
}

function mockDownload(filename) {
  showToast('üì• –°–∫–∞—á–∏–≤–∞–Ω–∏–µ: ' + filename);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// COMMISSION CALCULATOR (blogger price + 10% min)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let COMMISSION = 0.10;
// –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∫–æ–º–∏—Å—Å–∏–∏: {bloggerId: rate} ‚Äî override –≥–ª–æ–±–∞–ª—å–Ω–æ–π —Å—Ç–∞–≤–∫–∏
// –ö–ª—é—á–∏: id –±–ª–æ–≥–µ—Ä–∞ (1,2,3) –∏–ª–∏ 'service_<name>' –¥–ª—è —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã—Ö —É—Å–ª—É–≥
const CUSTOM_COMMISSIONS = {};

// –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ —É—Å–ª—É–≥–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã ‚Äî –º—É—Ç–∞–±–µ–ª—å–Ω—ã–π –º–∞—Å—Å–∏–≤
let EXCLUSIVE_SERVICES = [
  {key:'investfuture_review', name:'InvestFuture: –û–±–∑–æ—Ä –ø—Ä–æ–¥—É–∫—Ç–∞', desc:'–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–æ ‚Äî —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –Ω–∞—à—É –±–∏—Ä–∂—É. –ë–ª–æ–≥–µ—Ä—ã —Å –∞—É–¥–∏—Ç–æ—Ä–∏–µ–π 50K+.', comm:0.07, price:50000, bloggerId:null, bloggerName:null},
  {key:'bcs_podcast', name:'BCS: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø–æ–¥–∫–∞—Å—Ç', desc:'–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ –ë–ö–° –ë—Ä–æ–∫–µ—Ä.', comm:0.06, price:35000, bloggerId:null, bloggerName:null}
];

function calcComm() {
  const v = parseFloat(document.getElementById('dealAmt').value);
  const b = document.getElementById('commBox');
  if (!v || v <= 0) { b.style.display = 'none'; return; }
  b.style.display = 'block';
  const svcKey = (CB && CB_SI !== null && CB_SI >= 0) ? 'b'+CB.id+'_s'+CB_SI : null;
  const rate = (svcKey && CUSTOM_COMMISSIONS[svcKey] !== undefined)
    ? CUSTOM_COMMISSIONS[svcKey]
    : (CB ? (CUSTOM_COMMISSIONS[CB.id] ?? COMMISSION) : COMMISSION);
  const comm = Math.round(v * rate);
  const total = v + comm;
  const pct = Math.round(rate * 100);
  document.getElementById('c-blogger').textContent = '‚ÇΩ' + v.toLocaleString('ru');
  document.getElementById('c-comm').textContent = '+‚ÇΩ' + comm.toLocaleString('ru') + ' (' + pct + '%)';
  document.getElementById('c-total').textContent = '‚ÇΩ' + total.toLocaleString('ru');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ADMIN
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderAdmin() {
  const pendingCount = Object.values(VERIFICATIONS).filter(v => v.status === 'pending').length;
  const badge = document.getElementById('verifyBadgeSidebar');
  if (badge) badge.textContent = pendingCount > 0 ? pendingCount : '';
  document.getElementById('aStatUsers').textContent = USERS_LIST.filter(u => !u.banned).length;
  renderAdminVerifyQueue();
  setTimeout(drawCharts, 100);
}

function renderAdminVerifyQueue() {
  const el = document.getElementById('adminVerifyQueue'); if (!el) return;
  const pending = Object.entries(VERIFICATIONS).filter(([k, v]) => v.status === 'pending');
  if (pending.length === 0) { el.innerHTML = '<div class="es" style="padding:20px">–û—á–µ—Ä–µ–¥—å –ø—É—Å—Ç–∞ ‚úì</div>'; return; }
  el.innerHTML = pending.map(([key, v]) => `
    <div style="display:flex;align-items:center;gap:12px;padding:12px;background:#f9f9fc;border-radius:10px;margin-bottom:8px">
      <div style="width:38px;height:38px;border-radius:10px;background:linear-gradient(135deg,#6366f1,#a855f7);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:800;flex-shrink:0">${v.name[0]}${v.name.split(' ')[1]?.[0]||''}</div>
      <div style="flex:1"><div style="font-size:13px;font-weight:700">${v.name}</div><div style="font-size:12px;color:#888">${v.email} ¬∑ ${v.type}</div></div>
      <button class="btn btn-success btn-sm" onclick="verifyIssuer('${key}', true)">‚úì</button>
      <button class="btn btn-danger btn-sm" onclick="verifyIssuer('${key}', false)">‚úó</button>
    </div>`).join('');
}

function renderVerifyTab() {
  const el = document.getElementById('aVerifyCard'); if (!el) return;
  const pending = Object.entries(VERIFICATIONS).filter(([k, v]) => v.status === 'pending');
  if (pending.length === 0) {
    el.innerHTML = '<div class="es"><div class="es-icon">‚úÖ</div>–í—Å–µ —ç–º–∏—Ç–µ–Ω—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã</div>';
    return;
  }
  el.innerHTML = `<table class="tbl"><thead><tr><th>–ö–æ–º–ø–∞–Ω–∏—è</th><th>Email</th><th>–¢–∏–ø</th><th>–î–∞—Ç–∞</th><th>–î–µ–π—Å—Ç–≤–∏—è</th></tr></thead><tbody>` +
    pending.map(([key, v]) => `<tr>
      <td><b>${v.name}</b></td>
      <td>${v.email}</td>
      <td><span class="b bl">${v.type}</span></td>
      <td>${v.date}</td>
      <td style="display:flex;gap:8px">
        <button class="btn btn-success btn-sm" onclick="verifyIssuer('${key}', true)">–û–¥–æ–±—Ä–∏—Ç—å</button>
        <button class="btn btn-danger btn-sm" onclick="verifyIssuer('${key}', false)">–û—Ç–∫–ª–æ–Ω–∏—Ç—å</button>
      </td>
    </tr>`).join('') + '</tbody></table>';
}

function verifyIssuer(key, approved) {
  const v = VERIFICATIONS[key]; if (!v) return;
  if (approved) {
    v.status = 'approved';
    ACCS[key].verified = true;
    const u = USERS_LIST.find(u => u.email === v.email);
    if (u) u.status = 'verified';
    showToast(`‚úì ${v.name} –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω!`);
  } else {
    v.status = 'rejected';
    showToast(`‚úó ${v.name} –æ—Ç–∫–ª–æ–Ω—ë–Ω`);
  }
  renderAdmin();
  renderVerifyTab();
  renderUsersTab();
  // –û–±–Ω–æ–≤–ª—è–µ–º –±–µ–π–¥–∂
  const pendingCount = Object.values(VERIFICATIONS).filter(v => v.status === 'pending').length;
  const badge = document.getElementById('verifyBadgeSidebar');
  if (badge) badge.textContent = pendingCount > 0 ? pendingCount : '';
}

function renderUsersTab() {
  const el = document.getElementById('aUsersList'); if (!el) return;
  el.innerHTML = USERS_LIST.map((u, i) => {
    const roleColor = u.role==='ADMIN'?'r':u.role==='ISSUER'?'in':'pu';
    const statusLabel = u.banned ? '<span class="b r">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</span>' : u.status==='verified' ? '<span class="b g">–í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω</span>' : u.status==='pending' ? '<span class="b y">–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</span>' : '<span class="b g">–ê–∫—Ç–∏–≤–µ–Ω</span>';
    const avaColor = u.role==='ADMIN'?'#dc2626':u.role==='ISSUER'?'#6366f1':'#a855f7';
    return `<div class="user-row" onclick="openUserDetail(${i})">
      <div class="user-ava" style="background:${avaColor}">${u.name[0]}</div>
      <div style="flex:1">
        <div style="font-size:14px;font-weight:700">${u.name}</div>
        <div style="font-size:12px;color:#888">${u.email}</div>
      </div>
      <span class="b ${roleColor}" style="margin-right:8px">${u.role}</span>
      ${statusLabel}
      <div style="font-size:12px;color:#aaa;margin-left:12px">${u.date}</div>
    </div>`;
  }).join('');
}

function openUserDetail(i) {
  const u = USERS_LIST[i];
  document.getElementById('mUserTitle').textContent = u.name;
  const stats = u.role === 'ISSUER' ? `
    <div class="sc-grid" style="grid-template-columns:repeat(3,1fr);margin-bottom:16px">
      <div class="sc c1"><div class="v">1</div><div class="l">–ö–∞–º–ø–∞–Ω–∏–π</div></div>
      <div class="sc c2"><div class="v">‚ÇΩ0</div><div class="l">–û–±—ä—ë–º —Å–¥–µ–ª–æ–∫</div></div>
      <div class="sc c4"><div class="v">0</div><div class="l">–ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö</div></div>
    </div>` : u.role === 'BLOGGER' ? `
    <div class="sc-grid" style="grid-template-columns:repeat(3,1fr);margin-bottom:16px">
      <div class="sc c3"><div class="v">‚òÖ 4.3</div><div class="l">–†–µ–π—Ç–∏–Ω–≥</div></div>
      <div class="sc c2"><div class="v">‚ÇΩ30K</div><div class="l">–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</div></div>
      <div class="sc c1"><div class="v">3</div><div class="l">–°–¥–µ–ª–æ–∫</div></div>
    </div>` : '';
  document.getElementById('mUserBody').innerHTML = `
    <div style="display:flex;align-items:center;gap:14px;margin-bottom:20px;padding:16px;background:#f9f9fc;border-radius:12px">
      <div class="user-ava" style="width:52px;height:52px;font-size:18px;background:${u.role==='ADMIN'?'#dc2626':u.role==='ISSUER'?'#6366f1':'#a855f7'}">${u.name[0]}</div>
      <div>
        <div style="font-size:18px;font-weight:800">${u.name}</div>
        <div style="font-size:13px;color:#888">${u.email} ¬∑ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω ${u.date}</div>
      </div>
    </div>
    ${stats}
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      ${!u.banned && u.role !== 'ADMIN' ? `<button class="btn btn-danger btn-sm" onclick="banUser(${i})">üö´ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å</button>` : ''}
      ${u.banned ? `<button class="btn btn-success btn-sm" onclick="unbanUser(${i})">‚úì –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å</button>` : ''}
      ${u.status === 'pending' && u.role === 'ISSUER' ? `<button class="btn btn-success btn-sm" onclick="verifyFromUserModal('${u.email}')">‚úì –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å</button>` : ''}
      <button class="btn btn-warning btn-sm" onclick="showToast('üìß –ü–∏—Å—å–º–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ ${u.email}')">üìß –ù–∞–ø–∏—Å–∞—Ç—å</button>
      <button class="btn btn-secondary btn-sm" onclick="closeModal('mUser')">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>`;
  openModal('mUser');
}

function banUser(i) {
  USERS_LIST[i].banned = true;
  USERS_LIST[i].status = 'banned';
  showToast(`üö´ ${USERS_LIST[i].name} –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω`);
  closeModal('mUser');
  renderUsersTab();
  document.getElementById('aStatUsers').textContent = USERS_LIST.filter(u => !u.banned).length;
}

function unbanUser(i) {
  USERS_LIST[i].banned = false;
  USERS_LIST[i].status = 'active';
  showToast(`‚úì ${USERS_LIST[i].name} —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω`);
  closeModal('mUser');
  renderUsersTab();
  document.getElementById('aStatUsers').textContent = USERS_LIST.filter(u => !u.banned).length;
}

function verifyFromUserModal(email) {
  const key = Object.keys(ACCS).find(k => ACCS[k].email === email);
  if (key) verifyIssuer(key, true);
  closeModal('mUser');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ADMIN DISPUTES
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderDisputesTab() {
  const el = document.getElementById('aDisputesList'); if (!el) return;
  const open = DISPUTES.filter(d => d.status === 'open');
  const revision = DISPUTES.filter(d => d.status === 'revision');
  const resolved = DISPUTES.filter(d => d.status !== 'open' && d.status !== 'revision');
  let html = '';
  if (open.length > 0) {
    html += `<div style="font-size:13px;font-weight:700;color:#dc2626;margin-bottom:10px">üî¥ –û—Ç–∫—Ä—ã—Ç—ã–µ (${open.length})</div>`;
    html += open.map(d => renderDisputeCard(d)).join('');
  }
  if (revision.length > 0) {
    html += `<div style="font-size:13px;font-weight:700;color:#d97706;margin-top:20px;margin-bottom:10px">üîÑ –ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫–µ (${revision.length})</div>`;
    html += revision.map(d => renderDisputeCard(d)).join('');
  }
  if (resolved.length > 0) {
    html += `<div style="font-size:13px;font-weight:700;color:#16a34a;margin-top:20px;margin-bottom:10px">‚úÖ –†–µ—à—ë–Ω–Ω—ã–µ (${resolved.length})</div>`;
    html += resolved.map(d => renderDisputeCard(d)).join('');
  }
  if (DISPUTES.length === 0) html = '<div class="es"><div class="es-icon">‚úÖ</div>–°–ø–æ—Ä–æ–≤ –Ω–µ—Ç</div>';
  // Update open badge count (open + revision)
  const badge = document.getElementById('disputeCount');
  const activeCount = open.length + revision.length;
  if (badge) badge.textContent = activeCount > 0 ? activeCount + ' –∞–∫—Ç–∏–≤–Ω—ã—Ö' : '0 –∞–∫—Ç–∏–≤–Ω—ã—Ö';
  el.innerHTML = html;
}

function renderDisputeCard(d) {
  const statusMap = {
    open:            {cls:'r',  text:'üî¥ –û—Ç–∫—Ä—ã—Ç',          color:'#dc2626'},
    revision:        {cls:'y',  text:'üîÑ –ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫–µ',     color:'#d97706'},
    resolved_issuer: {cls:'bl', text:'üîµ –†–µ—à—ë–Ω (–≤–æ–∑–≤—Ä–∞—Ç)',  color:'#2563eb'},
    resolved_blogger:{cls:'g',  text:'‚úÖ –†–µ—à—ë–Ω (–≤—ã–ø–ª–∞—Ç–∞)',  color:'#16a34a'},
    resolved_split:  {cls:'in', text:'‚öñÔ∏è –†–µ—à—ë–Ω (50/50)',    color:'#6366f1'},
  };
  const s = statusMap[d.status] || statusMap.open;
  const statusClass = s.cls; const statusText = s.text;
  return `<div class="deal-card" style="border-left-color:${s.color};cursor:pointer" onclick="openDisputeDetail(${d.id})">
    <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px">
      <div>
        <div style="font-size:15px;font-weight:800">–°–ø–æ—Ä #${d.id}</div>
        <div style="font-size:12px;color:#888;margin-top:2px">${d.issuer} ‚Üî ${d.blogger} ¬∑ ${d.date}</div>
      </div>
      <span class="b ${statusClass}">${statusText}</span>
    </div>
    <div style="font-size:13px;color:#555;margin-bottom:8px">${d.reason.substring(0,80)}...</div>
    <div style="display:flex;gap:8px;align-items:center">
      <span class="b in">‚ÇΩ${d.total.toLocaleString('ru')} –≤ —ç—Å–∫—Ä–æ—É</span>
      <span style="font-size:12px;color:#888">${d.msgs.length} —Å–æ–æ–±—â–µ–Ω–∏–π</span>
      <button class="btn btn-primary btn-sm" style="margin-left:auto" onclick="event.stopPropagation();openDisputeDetail(${d.id})">–†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å ‚Üí</button>
    </div>
  </div>`;
}

function openDisputeDetail(id) {
  const d = DISPUTES.find(x => x.id === id); if (!d) return;
  document.getElementById('mDisputeTitle').textContent = `–°–ø–æ—Ä #${d.id}: ${d.issuer} ‚Üî ${d.blogger}`;
  document.getElementById('mDisputeBody').innerHTML = `
    <div class="g2" style="margin-bottom:16px">
      <div class="sc c1" style="padding:14px"><div class="v" style="font-size:16px">‚ÇΩ${d.amount.toLocaleString('ru')}</div><div class="l">–ì–æ–Ω–æ—Ä–∞—Ä –±–ª–æ–≥–µ—Ä–∞</div></div>
      <div class="sc c4" style="padding:14px"><div class="v" style="font-size:16px">‚ÇΩ${d.total.toLocaleString('ru')}</div><div class="l">–í—Å–µ–≥–æ –≤ —ç—Å–∫—Ä–æ—É (+10%)</div></div>
    </div>
    <div style="background:#fff3cd;border:1px solid #fde68a;border-radius:8px;padding:12px;margin-bottom:16px;font-size:13px">
      <b>–ü—Ä–∏—á–∏–Ω–∞ —Å–ø–æ—Ä–∞:</b> ${d.reason}
    </div>
    <div style="font-size:14px;font-weight:700;margin-bottom:10px">üí¨ –ü–µ—Ä–µ–ø–∏—Å–∫–∞ –ø–æ —Å–ø–æ—Ä—É</div>
    <div class="chat-wrap" style="margin-bottom:16px">
      <div class="chat-msgs" style="max-height:200px">
        ${d.msgs.map(m=>`<div class="chat-msg ${m.from==='admin'?'out':m.from==='issuer'?'in':'in'}" style="${m.from==='admin'?'':''}">
          <b>${m.from==='issuer'?d.issuer:m.from==='blogger'?d.blogger:'üëë –ê–¥–º–∏–Ω'}</b><br>${m.text}
          <div class="msg-time">${m.time}</div>
        </div>`).join('')}
      </div>
      <div class="chat-input-row">
        <input class="chat-input" id="disputeChatInput" placeholder="–ù–∞–ø–∏—Å–∞—Ç—å —Å—Ç–æ—Ä–æ–Ω–∞–º...">
        <button class="btn btn-primary btn-sm" onclick="sendDisputeMsg(${d.id})">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
      </div>
    </div>
    <div style="font-size:14px;font-weight:700;margin-bottom:10px">‚öñÔ∏è –ü—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏–µ</div>
    <div style="background:#f0f4ff;border-radius:8px;padding:10px 14px;margin-bottom:12px;font-size:12px;color:#555">
      üí° ¬´–ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É¬ª ‚Äî –ø–∞—É–∑–∞ —Å–ø–æ—Ä–∞, –±–ª–æ–≥–µ—Ä—É –¥–∞—ë—Ç—Å—è –≤—Ä–µ–º—è –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é. –°—Ä–µ–¥—Å—Ç–≤–∞ –æ—Å—Ç–∞—é—Ç—Å—è –≤ —ç—Å–∫—Ä–æ—É.
    </div>
    <div style="display:flex;gap:8px;flex-wrap:wrap">
      <button class="btn btn-danger btn-sm" onclick="resolveDispute(${d.id},'issuer')">üí∏ –í–µ—Ä–Ω—É—Ç—å —ç–º–∏—Ç–µ–Ω—Ç—É</button>
      <button class="btn btn-success btn-sm" onclick="resolveDispute(${d.id},'blogger')">‚úÖ –í—ã–ø–ª–∞—Ç–∏—Ç—å –±–ª–æ–≥–µ—Ä—É</button>
      <button class="btn btn-warning btn-sm" onclick="splitDispute(${d.id})">‚öñÔ∏è –†–∞–∑–¥–µ–ª–∏—Ç—å 50/50</button>
      <button class="btn btn-secondary btn-sm" onclick="requestRevision(${d.id})" style="background:#e0e7ff;color:#4338ca;border:none">üîÑ –ù–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É</button>
    </div>`;
  openModal('mDisputeDetail');
}

function sendDisputeMsg(id) {
  const inp = document.getElementById('disputeChatInput');
  const msg = inp.value.trim(); if (!msg) return;
  const d = DISPUTES.find(x => x.id === id); if (!d) return;
  const now = new Date();
  d.msgs.push({from:'admin', text:msg, time:`${now.getDate()} –º–∞—Ä, ${now.getHours()}:${String(now.getMinutes()).padStart(2,'0')}`});
  inp.value = '';
  openDisputeDetail(id);
  showToast('–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –æ–±–µ–∏–º —Å—Ç–æ—Ä–æ–Ω–∞–º');
}

function resolveDispute(id, winner) {
  const d = DISPUTES.find(x => x.id === id); if (!d) return;
  d.status = winner === 'issuer' ? 'resolved_issuer' : 'resolved_blogger';
  const text = winner === 'issuer' ? `üí∏ –°—Ä–µ–¥—Å—Ç–≤–∞ ‚ÇΩ${d.total.toLocaleString('ru')} –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã ${d.issuer}` : `‚úÖ –°—Ä–µ–¥—Å—Ç–≤–∞ ‚ÇΩ${d.amount.toLocaleString('ru')} –≤—ã–ø–ª–∞—á–µ–Ω—ã ${d.blogger}`;
  showToast(text);
  closeModal('mDisputeDetail');
  renderDisputesTab();
  const openCount = DISPUTES.filter(x => x.status === 'open').length;
  const badge = document.getElementById('disputeCount');
  if (badge) badge.textContent = openCount > 0 ? openCount + ' –æ—Ç–∫—Ä—ã—Ç—ã—Ö' : '0 –æ—Ç–∫—Ä—ã—Ç—ã—Ö';
  const sidebar = document.getElementById('verifyBadgeSidebar');
  renderAdmin();
}

function splitDispute(id) {
  const d = DISPUTES.find(x => x.id === id); if (!d) return;
  d.status = 'resolved_split';
  showToast(`‚öñÔ∏è –†–∞–∑–¥–µ–ª–µ–Ω–æ: ‚ÇΩ${Math.round(d.amount/2).toLocaleString('ru')} –∫–∞–∂–¥–æ–π —Å—Ç–æ—Ä–æ–Ω–µ`);
  closeModal('mDisputeDetail');
  renderDisputesTab();
  renderAdmin();
}

function requestRevision(id) {
  const d = DISPUTES.find(x => x.id === id); if (!d) return;
  const inp = document.getElementById('disputeChatInput');
  const comment = (inp && inp.value.trim()) || '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É. –ë–ª–æ–≥–µ—Ä—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —É—Å–ª–æ–≤–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞.';
  d.status = 'revision';
  const now = new Date();
  d.msgs.push({
    from:'admin',
    text:'üîÑ –°–ø–æ—Ä –ø–µ—Ä–µ–≤–µ–¥—ë–Ω –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É. ' + comment,
    time:`${now.getDate()} –º–∞—Ä, ${now.getHours()}:${String(now.getMinutes()).padStart(2,'0')}`
  });
  showToast('üîÑ –°–ø–æ—Ä –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –¥–æ—Ä–∞–±–æ—Ç–∫—É. –ë–ª–æ–≥–µ—Ä —É–≤–µ–¥–æ–º–ª—ë–Ω.');
  closeModal('mDisputeDetail');
  renderDisputesTab();
  renderAdmin();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ADMIN STAT ANALYTICS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function openAdminStat(type) { try {
  const titles = {users:'üë• –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏', bloggers:'üì± –ë–ª–æ–≥–µ—Ä—ã', issuers:'üè¢ –≠–º–∏—Ç–µ–Ω—Ç—ã', escrow:'üí∞ –≠—Å–∫—Ä–æ—É-–æ–ø–µ—Ä–∞—Ü–∏–∏'};
  document.getElementById('mAdminStatTitle').textContent = titles[type] || '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞';
  const filterBar = (id, placeholderSearch, extraControls='') => `
    <div style="display:flex;gap:8px;margin-bottom:14px;flex-wrap:wrap">
      <input class="fi-sm" id="astat-search-${id}" placeholder="${placeholderSearch}" oninput="filterAdminStat('${id}')" style="flex:1;min-width:180px">
      ${extraControls}
    </div>
    <div id="astat-list-${id}"></div>`;
  let html = '';
  if (type === 'users') {
    html = `<div class="sc-grid" style="grid-template-columns:repeat(3,1fr);margin-bottom:16px">
      <div class="sc c1"><div class="v">${USERS_LIST.length}</div><div class="l">–í—Å–µ–≥–æ</div></div>
      <div class="sc c2"><div class="v">${USERS_LIST.filter(u=>!u.banned).length}</div><div class="l">–ê–∫—Ç–∏–≤–Ω—ã—Ö</div></div>
      <div class="sc c4"><div class="v">${USERS_LIST.filter(u=>u.banned).length}</div><div class="l">–ó–∞–±–ª–æ–∫.</div></div>
    </div>` + filterBar('users','üîç –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ email...',
      `<select class="fi-sm" id="astat-role-users" onchange="filterAdminStat('users')" style="min-width:120px">
        <option value="">–í—Å–µ —Ä–æ–ª–∏</option><option value="ADMIN">ADMIN</option><option value="ISSUER">ISSUER</option><option value="BLOGGER">BLOGGER</option>
      </select>`);
  } else if (type === 'bloggers') {
    const avgR = (BLOGGERS.reduce((a,b)=>a+b.r,0)/BLOGGERS.length).toFixed(1);
    const totalDeals = BLOGGERS.reduce((a,b)=>a+b.deals,0);
    html = `<div class="sc-grid" style="grid-template-columns:repeat(3,1fr);margin-bottom:16px">
      <div class="sc c3"><div class="v">${BLOGGERS.length}</div><div class="l">–ë–ª–æ–≥–µ—Ä–æ–≤</div></div>
      <div class="sc c1"><div class="v">${totalDeals}</div><div class="l">–°–¥–µ–ª–æ–∫ –≤—Å–µ–≥–æ</div></div>
      <div class="sc c2"><div class="v">‚òÖ ${avgR}</div><div class="l">–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥</div></div>
    </div>` + filterBar('bloggers','üîç –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ –Ω–∏—à–µ...',
      `<select class="fi-sm" id="astat-sort-bloggers" onchange="filterAdminStat('bloggers')" style="min-width:140px">
        <option value="rating">–ü–æ —Ä–µ–π—Ç–∏–Ω–≥—É ‚Üì</option><option value="deals">–ü–æ —Å–¥–µ–ª–∫–∞–º ‚Üì</option><option value="name">–ü–æ –∏–º–µ–Ω–∏ –ê-–Ø</option>
      </select>
      <select class="fi-sm" id="astat-plat-bloggers" onchange="filterAdminStat('bloggers')" style="min-width:140px">
        <option value="">–í—Å–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã</option><option value="Telegram">Telegram</option><option value="YouTube">YouTube</option>
        <option value="VK">VK</option><option value="Twitter/X">Twitter/X</option>
      </select>`);
  } else if (type === 'issuers') {
    const issuers = Object.entries(ACCS).filter(([k,v])=>v.role==='ISSUER');
    const verCount = issuers.filter(([k,v])=>v.verified).length;
    html = `<div class="sc-grid" style="grid-template-columns:repeat(3,1fr);margin-bottom:16px">
      <div class="sc c1"><div class="v">${issuers.length}</div><div class="l">–≠–º–∏—Ç–µ–Ω—Ç–æ–≤</div></div>
      <div class="sc c2"><div class="v">${verCount}</div><div class="l">–í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ</div></div>
      <div class="sc c4"><div class="v">${issuers.length-verCount}</div><div class="l">–ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</div></div>
    </div>` + filterBar('issuers','üîç –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∫–æ–º–ø–∞–Ω–∏–∏...',
      `<select class="fi-sm" id="astat-status-issuers" onchange="filterAdminStat('issuers')" style="min-width:160px">
        <option value="">–õ—é–±–æ–π —Å—Ç–∞—Ç—É—Å</option><option value="verified">‚úì –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ</option><option value="pending">‚è≥ –ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</option>
      </select>
      <select class="fi-sm" id="astat-sort-issuers" onchange="filterAdminStat('issuers')" style="min-width:130px">
        <option value="name">–ü–æ –∏–º–µ–Ω–∏ –ê-–Ø</option><option value="deals_desc">–ü–æ —Å–¥–µ–ª–∫–∞–º ‚Üì</option><option value="rating_desc">–ü–æ —Ä–µ–π—Ç–∏–Ω–≥—É ‚Üì</option>
      </select>`);
  } else if (type === 'escrow') {
    const escrowAmt = 10000; const paidAmt = 30000;
    const escrowComm = Math.round(escrowAmt * COMMISSION);
    const paidComm = Math.round(paidAmt * COMMISSION);
    html = `<div class="sc-grid" style="grid-template-columns:repeat(3,1fr);margin-bottom:16px">
      <div class="sc c2"><div class="v">‚ÇΩ${(escrowAmt+escrowComm).toLocaleString('ru')}</div><div class="l">–í —ç—Å–∫—Ä–æ—É</div></div>
      <div class="sc c1"><div class="v">‚ÇΩ${paidAmt.toLocaleString('ru')}</div><div class="l">–í—ã–ø–ª–∞—á–µ–Ω–æ</div></div>
      <div class="sc c4"><div class="v">‚ÇΩ${(escrowComm+paidComm).toLocaleString('ru')}</div><div class="l">–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</div></div>
    </div>
    <table class="tbl"><thead><tr><th>–°–¥–µ–ª–∫–∞</th><th>–°—É–º–º–∞</th><th>–ö–æ–º–∏—Å—Å–∏—è</th><th>–°—Ç–∞—Ç—É—Å</th></tr></thead><tbody>
      <tr><td>BingX ‚Üí –ö—Ä–∏–ø—Ç–æ –ë–ª–æ–≥–µ—Ä 1</td><td>‚ÇΩ10 000</td><td>‚ÇΩ1 000</td><td><span class="b y">–í —ç—Å–∫—Ä–æ—É</span></td></tr>
      <tr><td>BingX ‚Üí –ò–Ω–≤–µ—Å—Ç –ë–ª–æ–≥–µ—Ä</td><td>‚ÇΩ20 000</td><td>‚ÇΩ2 000</td><td><span class="b g">–í—ã–ø–ª–∞—á–µ–Ω–æ</span></td></tr>
      <tr><td>BingX ‚Üí –ö—Ä–∏–ø—Ç–æ –ë–ª–æ–≥–µ—Ä 1</td><td>‚ÇΩ10 000</td><td>‚ÇΩ1 000</td><td><span class="b g">–í—ã–ø–ª–∞—á–µ–Ω–æ</span></td></tr>
    </tbody></table>`;
  }
  document.getElementById('mAdminStatBody').innerHTML = html;
  // Trigger initial filter render for searchable types
  if (['users','bloggers','issuers'].includes(type)) filterAdminStat(type);
  openModal('mAdminStat');
} catch(e) { showToast('‚ùå –û—à–∏–±–∫–∞: ' + e.message, 1); console.error('openAdminStat error:', e); }
}

function filterAdminStat(type) {
  const q = (document.getElementById('astat-search-'+type)?.value || '').toLowerCase();
  const listEl = document.getElementById('astat-list-'+type); if (!listEl) return;
  if (type === 'users') {
    const role = document.getElementById('astat-role-users')?.value || '';
    let list = USERS_LIST.filter(u => {
      const match = !q || u.name.toLowerCase().includes(q) || u.email.toLowerCase().includes(q);
      const roleMatch = !role || u.role === role;
      return match && roleMatch;
    });
    if (list.length === 0) { listEl.innerHTML = '<div class="es" style="padding:16px">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>'; return; }
    listEl.innerHTML = list.map((u,i)=>{
      const rc = u.role==='ADMIN'?'r':u.role==='ISSUER'?'in':'pu';
      return `<div class="user-row" onclick="closeModal('mAdminStat');openUserDetail(${USERS_LIST.indexOf(u)})" style="cursor:pointer">
        <div class="user-ava" style="background:${u.role==='ADMIN'?'#dc2626':u.role==='ISSUER'?'#6366f1':'#a855f7'}">${u.name[0]}</div>
        <div style="flex:1"><div style="font-weight:700;font-size:14px">${u.name}</div><div style="font-size:12px;color:#888">${u.email} ¬∑ ${u.date}</div></div>
        <span class="b ${rc}">${u.role}</span>
      </div>`;
    }).join('');
  } else if (type === 'bloggers') {
    const sort = document.getElementById('astat-sort-bloggers')?.value || 'rating';
    const plat = document.getElementById('astat-plat-bloggers')?.value || '';
    let list = BLOGGERS.filter(b => {
      const match = !q || b.n.toLowerCase().includes(q) || b.niche.toLowerCase().includes(q);
      const platMatch = !plat || b.s.some(s => s.plat === plat);
      return match && platMatch;
    });
    if (sort === 'rating') list.sort((a,b)=>b.r-a.r);
    else if (sort === 'deals') list.sort((a,b)=>b.deals-a.deals);
    else list.sort((a,b)=>a.n.localeCompare(b.n,'ru'));
    if (list.length === 0) { listEl.innerHTML = '<div class="es" style="padding:16px">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>'; return; }
    listEl.innerHTML = list.map(b=>`<div class="user-row">
      <div class="bc-av" style="width:38px;height:38px;border-radius:10px;font-size:14px;margin-bottom:0">${b.n[0]}</div>
      <div style="flex:1">
        <div style="font-weight:700;font-size:14px">${b.n}</div>
        <div style="font-size:12px;color:#888">${b.niche} ¬∑ ${b.geo} ¬∑ ${b.s.length} –ø–ª–∞—Ç—Ñ–æ—Ä–º</div>
        <div style="font-size:11px;color:#aaa;margin-top:2px">${b.s.map(s=>`${PLATFORM_ICONS[s.plat]||'üì°'} ${(s.subs/1000).toFixed(0)}K`).join(' ¬∑ ')}</div>
      </div>
      <div style="text-align:right">
        <span class="b gr" style="display:block;margin-bottom:4px">‚úÖ ${b.deals} —Å–¥–µ–ª–æ–∫</span>
        <span class="b in">‚òÖ ${b.r}</span>
      </div>
    </div>`).join('');
  } else if (type === 'issuers') {
    const statusF = document.getElementById('astat-status-issuers')?.value || '';
    const sort = document.getElementById('astat-sort-issuers')?.value || 'name';
    let list = Object.entries(ACCS).filter(([k,v])=>v.role==='ISSUER').filter(([k,v])=>{
      const match = !q || v.name.toLowerCase().includes(q) || v.email.toLowerCase().includes(q);
      const statusMatch = !statusF || (statusF==='verified'?v.verified:!v.verified);
      return match && statusMatch;
    });
    if (sort === 'deals_desc') list.sort(([,a],[,b])=>(b.deals||0)-(a.deals||0));
    else if (sort === 'rating_desc') list.sort(([,a],[,b])=>(b.r||0)-(a.r||0));
    else list.sort(([,a],[,b])=>a.name.localeCompare(b.name,'ru'));
    if (list.length === 0) { listEl.innerHTML = '<div class="es" style="padding:16px">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>'; return; }
    listEl.innerHTML = list.map(([k,v])=>`
      <div class="user-row">
        <div class="user-ava" style="background:#6366f1">${v.name[0]}</div>
        <div style="flex:1">
          <div style="font-weight:700">${v.name}</div>
          <div style="font-size:12px;color:#888">${v.email} ¬∑ ${v.type||'ISSUER'}</div>
          ${v.site?`<div style="font-size:11px;color:#6366f1">${v.site}</div>`:''}
        </div>
        <div style="text-align:right">
          ${v.verified?'<span class="b g">‚úì –í–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω</span>':'<span class="b y">‚è≥ –ù–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</span>'}
          ${v.r?`<br><span class="b in" style="margin-top:4px">‚òÖ ${v.r} ¬∑ ${v.deals} —Å–¥–µ–ª–æ–∫</span>`:''}
        </div>
      </div>`).join('');
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// COMMISSION MANAGEMENT (Admin)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderCommissionsTab() {
  // Update global rate display
  const globalPct = Math.round(COMMISSION * 100);
  const disp = document.getElementById('globalCommDisplay');
  const inp = document.getElementById('globalCommInput');
  if (disp) disp.textContent = globalPct + '%';
  if (inp) inp.value = globalPct;
  renderBloggerCommList();
  renderExclusiveServices();
}

function renderBloggerCommList(filter) {
  const bList = document.getElementById('bloggerCommList');
  if (!bList) return;
  const globalPct = Math.round(COMMISSION * 100);
  const q = (filter !== undefined ? filter : (document.getElementById('commBloggerSearch')?.value || '')).toLowerCase();
  let list = BLOGGERS.filter(b => !q || b.n.toLowerCase().includes(q) || b.niche.toLowerCase().includes(q));

  if (list.length === 0) {
    bList.innerHTML = '<div class="es" style="padding:20px">–ë–ª–æ–≥–µ—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
    return;
  }

  bList.innerHTML = list.map(b => {
    const baseCustom = CUSTOM_COMMISSIONS[b.id];
    const basePct = baseCustom !== undefined ? Math.round(baseCustom*100) : globalPct;
    const hasBase = baseCustom !== undefined;
    // Count per-service overrides
    const svcOverrides = b.p.filter((p,si) => CUSTOM_COMMISSIONS['b'+b.id+'_s'+si] !== undefined).length;
    const expanded = window._commExpanded && window._commExpanded[b.id];

    const serviceRows = b.p.map((p, si) => {
      const key = 'b'+b.id+'_s'+si;
      const svcCustom = CUSTOM_COMMISSIONS[key];
      const svcPct = svcCustom !== undefined ? Math.round(svcCustom*100) : '';
      const hasSvc = svcCustom !== undefined;
      return `<div style="display:flex;align-items:center;gap:8px;padding:7px 10px;background:${hasSvc?'#eff6ff':'#f8f8fb'};border-radius:8px;margin:3px 0;border:1px solid ${hasSvc?'#bfdbfe':'#eee'}">
        <div style="flex:1;min-width:0">
          <div style="font-size:13px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis">${p.n}</div>
          <div style="font-size:11px;color:#aaa">‚ÇΩ${p.p.toLocaleString('ru')} ¬∑ ${hasSvc?'<span style="color:#3b82f6;font-weight:700">–∏–Ω–¥–∏–≤. '+Math.round(svcCustom*100)+'%</span>':'–Ω–∞—Å–ª–µ–¥—É–µ—Ç –±–∞–∑–æ–≤—É—é ('+basePct+'%)'}</div>
        </div>
        <input class="fi" type="number" id="svc_${b.id}_${si}" min="0" max="50" step="0.5" value="${svcPct}" placeholder="${basePct}" style="width:68px;padding:4px 8px;font-size:12px;flex-shrink:0">
        <span style="font-size:12px;font-weight:700;flex-shrink:0">%</span>
        <button class="btn btn-success btn-sm" style="padding:4px 8px;flex-shrink:0" onclick="saveServiceCommByBlogger(${b.id},${si})">‚úì</button>
        ${hasSvc?`<button class="btn btn-secondary btn-sm" style="padding:4px 8px;flex-shrink:0" onclick="resetServiceComm(${b.id},${si})" title="–°–±—Ä–æ—Å">‚úï</button>`:''}
      </div>`;
    }).join('');

    return `<div style="border:1px solid ${hasBase?'#86efac':'#e5e5e5'};border-radius:12px;margin-bottom:10px;overflow:hidden">
      <!-- Header row (always visible) -->
      <div style="display:flex;align-items:center;gap:10px;padding:12px;background:${hasBase?'#f0fdf4':'#f9f9fc'};cursor:pointer" onclick="toggleCommRow(${b.id})">
        <div class="bc-av" style="width:36px;height:36px;border-radius:10px;font-size:14px;margin-bottom:0;flex-shrink:0">${b.n[0]}</div>
        <div style="flex:1;min-width:0">
          <div style="font-weight:700;font-size:14px">${b.n}</div>
          <div style="font-size:12px;color:#888">${b.niche} ¬∑ ${b.p.length} —É—Å–ª—É–≥${svcOverrides>0?` ¬∑ <span style="color:#3b82f6">üéØ ${svcOverrides} –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–æ</span>`:''}</div>
        </div>
        <!-- Inline base rate controls -->
        <div style="display:flex;align-items:center;gap:6px;flex-shrink:0" onclick="event.stopPropagation()">
          <span style="font-size:12px;color:#888">–ë–∞–∑–∞:</span>
          <input class="fi" type="number" id="bcomm_${b.id}" min="0" max="50" step="0.5" value="${basePct}" style="width:70px;padding:4px 8px;font-size:13px" placeholder="${globalPct}">
          <span style="font-weight:700;font-size:12px">%</span>
          <button class="btn btn-success btn-sm" style="padding:4px 8px" onclick="saveBloggerComm(${b.id})">‚úì</button>
          ${hasBase?`<button class="btn btn-secondary btn-sm" style="padding:4px 8px" onclick="resetBloggerComm(${b.id})" title="–°–±—Ä–æ—Å">‚úï</button>`:''}
        </div>
        <div style="font-size:18px;color:#aaa;flex-shrink:0;transition:.2s;transform:${expanded?'rotate(180deg)':'rotate(0deg)'}">${expanded?'‚ñ≤':'‚ñº'}</div>
      </div>
      <!-- Expandable services -->
      ${expanded ? `<div style="padding:8px 12px 10px;background:#fff;border-top:1px solid #f0f0f8">${serviceRows}</div>` : ''}
    </div>`;
  }).join('');
}

function toggleCommRow(bloggerId) {
  if (!window._commExpanded) window._commExpanded = {};
  window._commExpanded[bloggerId] = !window._commExpanded[bloggerId];
  renderBloggerCommList();
}

function renderExclusiveServices() {
  const el = document.getElementById('exclusiveServicesList'); if (!el) return;
  if (EXCLUSIVE_SERVICES.length === 0) {
    el.innerHTML = '<div class="es" style="padding:16px">–ù–µ—Ç —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã—Ö —É—Å–ª—É–≥. –ù–∞–∂–º–∏—Ç–µ ¬´–î–æ–±–∞–≤–∏—Ç—å¬ª –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è.</div>';
    return;
  }
  el.innerHTML = EXCLUSIVE_SERVICES.map((svc, i) => `
    <div style="padding:14px;background:#fafafa;border-radius:10px;margin-bottom:10px;border:1px solid #e5e5e5">
      <div style="display:flex;align-items:flex-start;justify-content:space-between;gap:12px;flex-wrap:wrap">
        <div style="flex:1;min-width:220px">
          <div style="font-size:14px;font-weight:700;color:#1e1e2e">üåü ${svc.name}</div>
          <div style="font-size:12px;color:#888;margin-top:3px">${svc.desc}</div>
          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:6px">
            <span style="font-size:12px;color:#6366f1">‚ÇΩ${svc.price.toLocaleString('ru')}</span>
            ${svc.bloggerName ? `<span style="font-size:12px;background:#e8f5e9;color:#16a34a;padding:1px 8px;border-radius:20px">üë§ ${svc.bloggerName}</span>` : '<span style="font-size:12px;color:#aaa">–ë–µ–∑ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –±–ª–æ–≥–µ—Ä—É</span>'}
          </div>
        </div>
        <div style="display:flex;align-items:center;gap:8px;flex-shrink:0">
          <label style="font-size:12px;color:#888">–°—Ç–∞–≤–∫–∞:</label>
          <input class="fi" type="number" id="scomm_${i}" min="0" max="50" step="0.5" value="${Math.round(svc.comm*100)}" style="width:70px;padding:6px 8px">
          <span style="font-weight:700">%</span>
          <button class="btn btn-success btn-sm" onclick="saveServiceComm(${i})">‚úì</button>
          <button class="btn btn-danger btn-sm" onclick="deleteExclusiveService(${i})">üóë</button>
        </div>
      </div>
    </div>`).join('');
}

function saveGlobalComm() {
  const inp = document.getElementById('globalCommInput');
  const v = parseFloat(inp?.value);
  if (isNaN(v) || v < 0 || v > 50) { showToast('–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç 0 –¥–æ 50%', 1); return; }
  COMMISSION = v / 100;
  const disp = document.getElementById('globalCommDisplay');
  if (disp) disp.textContent = v + '%';
  showToast('‚úì –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞: ' + v + '%');
  renderBloggerCommList();
}

function saveBloggerComm(bloggerId) {
  const b = BLOGGERS.find(x => x.id === bloggerId);
  const inp = document.getElementById('bcomm_' + bloggerId);
  const v = parseFloat(inp?.value);
  if (isNaN(v) || v < 0 || v > 50) { showToast('–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç 0 –¥–æ 50%', 1); return; }
  CUSTOM_COMMISSIONS[bloggerId] = v / 100;
  showToast('‚úì ' + (b?.n || '–ë–ª–æ–≥–µ—Ä') + ': –±–∞–∑–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞ ' + v + '%');
  renderBloggerCommList();
}

function resetBloggerComm(bloggerId) {
  const b = BLOGGERS.find(x => x.id === bloggerId);
  delete CUSTOM_COMMISSIONS[bloggerId];
  showToast('‚Ü©Ô∏è –°—Ç–∞–≤–∫–∞ –¥–ª—è ' + (b?.n || '–±–ª–æ–≥–µ—Ä–∞') + ' —Å–±—Ä–æ—à–µ–Ω–∞ –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–π (' + Math.round(COMMISSION * 100) + '%)');
  renderBloggerCommList();
}

function saveServiceComm(idx) {
  const v = parseFloat(document.getElementById('scomm_' + idx)?.value);
  if (isNaN(v) || v < 0 || v > 50) { showToast('–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç 0 –¥–æ 50%', 1); return; }
  EXCLUSIVE_SERVICES[idx].comm = v / 100;
  CUSTOM_COMMISSIONS['service_' + EXCLUSIVE_SERVICES[idx].key] = v / 100;
  showToast(`‚úì –°—Ç–∞–≤–∫–∞ –¥–ª—è ¬´${EXCLUSIVE_SERVICES[idx].name}¬ª: ${v}%`);
  renderExclusiveServices();
}

function deleteExclusiveService(idx) {
  const svc = EXCLUSIVE_SERVICES[idx];
  delete CUSTOM_COMMISSIONS['service_' + svc.key];
  EXCLUSIVE_SERVICES.splice(idx, 1);
  showToast(`–£—Å–ª—É–≥–∞ ¬´${svc.name}¬ª —É–¥–∞–ª–µ–Ω–∞`);
  renderExclusiveServices();
}

function addExclusiveService() {
  // Populate blogger dropdown
  const sel = document.getElementById('exclBlogger');
  if (sel) {
    sel.innerHTML = '<option value="">‚Äî –î–æ—Å—Ç—É–ø–Ω–æ –≤—Å–µ–º –ø–æ–¥—Ö–æ–¥—è—â–∏–º –±–ª–æ–≥–µ—Ä–∞–º ‚Äî</option>' +
      BLOGGERS.map(b => `<option value="${b.id}">${b.n} (${b.s[0]?.plat || '‚Äî'}, ${(b.s[0]?.subs/1000||0).toFixed(0)}K)</option>`).join('');
  }
  // Clear form
  ['exclName','exclDesc','exclPrice'].forEach(id => { const el = document.getElementById(id); if(el) el.value = ''; });
  const commEl = document.getElementById('exclComm'); if (commEl) commEl.value = '10';
  openModal('mAddExcl');
}

function submitAddExclusiveService() {
  const name = document.getElementById('exclName')?.value.trim();
  if (!name) { showToast('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏', 1); return; }
  const desc = document.getElementById('exclDesc')?.value.trim() || '';
  const bloggerId = document.getElementById('exclBlogger')?.value || '';
  const price = parseInt(document.getElementById('exclPrice')?.value || '0', 10) || 0;
  const commPct = parseFloat(document.getElementById('exclComm')?.value || '10');
  const comm = (isNaN(commPct) ? 10 : commPct) / 100;
  const key = 'custom_' + Date.now();
  const blogger = BLOGGERS.find(b => b.id == bloggerId);
  EXCLUSIVE_SERVICES.push({key, name, desc, comm, price, bloggerId: bloggerId || null, bloggerName: blogger?.n || null});
  CUSTOM_COMMISSIONS['service_' + key] = comm;
  showToast(`‚úì –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–∞—è —É—Å–ª—É–≥–∞ ¬´${name}¬ª –¥–æ–±–∞–≤–ª–µ–Ω–∞${blogger ? ' ‚Üí ' + blogger.n : ''}`);
  closeModal('mAddExcl');
  renderExclusiveServices();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ADMIN TAGS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderAdminTagsTab() {
  const list = document.getElementById('adminTagsList');
  const stats = document.getElementById('adminTagsStats');
  if (!list) return;

  // Count usage across all bloggers
  const usageCounts = {};
  ALL_TAGS.forEach(t => usageCounts[t] = 0);
  BLOGGERS.forEach(b => b.tags.forEach(t => { if (usageCounts[t] !== undefined) usageCounts[t]++; }));

  list.innerHTML = ALL_TAGS.map((t,i) => `
    <div style="display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1.5px solid #c7d2fe;border-radius:8px;padding:5px 10px">
      <span style="font-size:13px;font-weight:600;color:#4338ca">#${t}</span>
      <span style="font-size:11px;color:#818cf8">${usageCounts[t] || 0} –∞–≤—Ç.</span>
      <button onclick="removeAdminTag(${i})" style="background:none;border:none;cursor:pointer;color:#a5b4fc;font-size:14px;line-height:1;padding:0;margin-left:2px" title="–£–¥–∞–ª–∏—Ç—å —Ç–µ–≥">√ó</button>
    </div>`).join('');

  if (stats) {
    const sorted = [...ALL_TAGS].sort((a,b) => (usageCounts[b]||0) - (usageCounts[a]||0));
    stats.innerHTML = sorted.map(t => {
      const count = usageCounts[t] || 0;
      const maxCount = Math.max(...Object.values(usageCounts), 1);
      const pct = Math.round(count / BLOGGERS.length * 100);
      return `<div style="display:flex;align-items:center;gap:8px;width:100%;padding:4px 0">
        <span style="font-size:13px;font-weight:600;color:#444;min-width:90px">#${t}</span>
        <div style="flex:1;background:#f0f0f8;border-radius:4px;height:8px">
          <div style="width:${Math.round(count/BLOGGERS.length*100)}%;background:#6366f1;border-radius:4px;height:8px;min-width:${count>0?4:0}px"></div>
        </div>
        <span style="font-size:12px;color:#888;min-width:50px">${count}/${BLOGGERS.length} –∞–≤—Ç.</span>
      </div>`;
    }).join('');
  }
}

function addAdminTag() {
  const name = prompt('–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–µ–≥–∞ (–±–µ–∑ #):');
  if (!name) return;
  const clean = name.trim().toLowerCase().replace(/[^a-z–∞-—è—ë0-9_\-\.]/gi,'');
  if (!clean) { showToast('–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–µ–≥–∞', 1); return; }
  if (ALL_TAGS.includes(clean)) { showToast('–¢–µ–≥ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç', 1); return; }
  ALL_TAGS.push(clean);
  showToast('‚úÖ –¢–µ–≥ #' + clean + ' –¥–æ–±–∞–≤–ª–µ–Ω');
  renderAdminTagsTab();
  renderProfileTags();
}

function removeAdminTag(idx) {
  const tag = ALL_TAGS[idx];
  if (!confirm('–£–¥–∞–ª–∏—Ç—å —Ç–µ–≥ #' + tag + '? –û–Ω –±—É–¥–µ—Ç —É–±—Ä–∞–Ω –∏–∑ –ø—Ä–æ—Ñ–∏–ª–µ–π –±–ª–æ–≥–µ—Ä–æ–≤.')) return;
  ALL_TAGS.splice(idx, 1);
  BLOGGERS.forEach(b => { b.tags = b.tags.filter(t => t !== tag); });
  showToast('üóë –¢–µ–≥ #' + tag + ' —É–¥–∞–ª—ë–Ω');
  renderAdminTagsTab();
}

function saveServiceCommByBlogger(bloggerId, serviceIdx) {
  const b = BLOGGERS.find(x => x.id === bloggerId);
  const svc = b?.p[serviceIdx];
  const inp = document.getElementById('svc_' + bloggerId + '_' + serviceIdx);
  const v = parseFloat(inp?.value);
  if (isNaN(v) || v < 0 || v > 50) { showToast('–í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç 0 –¥–æ 50%', 1); return; }
  const key = 'b' + bloggerId + '_s' + serviceIdx;
  CUSTOM_COMMISSIONS[key] = v / 100;
  showToast('‚úì –£—Å–ª—É–≥–∞ ¬´' + (svc?.n || '') + '¬ª (' + (b?.n || '') + '): ' + v + '%');
  renderBloggerCommList();
}

function resetServiceComm(bloggerId, serviceIdx) {
  const b = BLOGGERS.find(x => x.id === bloggerId);
  const svc = b?.p[serviceIdx];
  delete CUSTOM_COMMISSIONS['b' + bloggerId + '_s' + serviceIdx];
  showToast('‚Ü©Ô∏è –°—Ç–∞–≤–∫–∞ —É—Å–ª—É–≥–∏ ¬´' + (svc?.n || '') + '¬ª —Å–±—Ä–æ—à–µ–Ω–∞');
  renderBloggerCommList();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CHARTS (Canvas API ‚Äî –±–µ–∑ CDN)
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function drawCharts() {
  drawBarChart('chartDeals',
    ['–û–∫—Ç','–ù–æ—è','–î–µ–∫','–Ø–Ω–≤','–§–µ–≤','–ú–∞—Ä'],
    [85000, 120000, 98000, 145000, 210000, 87000],
    '#6366f1');
  drawBarChart('chartUsers',
    ['–û–∫—Ç','–ù–æ—è','–î–µ–∫','–Ø–Ω–≤','–§–µ–≤','–ú–∞—Ä'],
    [12, 18, 14, 27, 35, 9],
    '#a855f7');
  drawLineChart('chartComm',
    ['–û–∫—Ç','–ù–æ—è','–î–µ–∫','–Ø–Ω–≤','–§–µ–≤','–ú–∞—Ä'],
    [6800, 9600, 7840, 11600, 16800, 6960],
    '#16a34a');
}

function drawBarChart(canvasId, labels, data, color) {
  const c = document.getElementById(canvasId); if (!c) return;
  const ctx = c.getContext('2d');
  const w = c.width, h = c.height;
  const pad = {l:44, r:12, t:12, b:28};
  const cw = w - pad.l - pad.r, ch = h - pad.t - pad.b;
  ctx.clearRect(0, 0, w, h);
  const max = Math.max(...data) * 1.15 || 1;
  // Grid
  ctx.strokeStyle = '#f0f0f8'; ctx.lineWidth = 1;
  for (let i = 0; i <= 4; i++) {
    const y = pad.t + ch - (i/4)*ch;
    ctx.beginPath(); ctx.moveTo(pad.l, y); ctx.lineTo(w - pad.r, y); ctx.stroke();
    ctx.fillStyle = '#aaa'; ctx.font = '10px system-ui'; ctx.textAlign = 'right';
    ctx.fillText(fmtShort(max*i/4), pad.l - 4, y + 3);
  }
  // Bars
  const bw = (cw / labels.length) * 0.6;
  const gap = cw / labels.length;
  labels.forEach((label, i) => {
    const bh = (data[i] / max) * ch;
    const x = pad.l + gap * i + gap * 0.2;
    const y = pad.t + ch - bh;
    // Gradient
    const grad = ctx.createLinearGradient(0, y, 0, y + bh);
    grad.addColorStop(0, color);
    grad.addColorStop(1, color + '88');
    ctx.fillStyle = grad;
    const r = 4;
    ctx.beginPath();
    ctx.moveTo(x + r, y); ctx.lineTo(x + bw - r, y);
    ctx.arcTo(x+bw, y, x+bw, y+r, r);
    ctx.lineTo(x+bw, y+bh); ctx.lineTo(x, y+bh); ctx.lineTo(x, y+r);
    ctx.arcTo(x, y, x+r, y, r); ctx.closePath();
    ctx.fill();
    // Label
    ctx.fillStyle = '#888'; ctx.font = '10px system-ui'; ctx.textAlign = 'center';
    ctx.fillText(label, x + bw/2, h - pad.b + 14);
  });
}

function drawLineChart(canvasId, labels, data, color) {
  const c = document.getElementById(canvasId); if (!c) return;
  const ctx = c.getContext('2d');
  const w = c.width, h = c.height;
  const pad = {l:44, r:12, t:12, b:28};
  const cw = w - pad.l - pad.r, ch = h - pad.t - pad.b;
  ctx.clearRect(0, 0, w, h);
  const max = Math.max(...data) * 1.15 || 1;
  ctx.strokeStyle = '#f0f0f8'; ctx.lineWidth = 1;
  for (let i = 0; i <= 4; i++) {
    const y = pad.t + ch - (i/4)*ch;
    ctx.beginPath(); ctx.moveTo(pad.l, y); ctx.lineTo(w - pad.r, y); ctx.stroke();
    ctx.fillStyle = '#aaa'; ctx.font = '10px system-ui'; ctx.textAlign = 'right';
    ctx.fillText(fmtShort(max*i/4), pad.l - 4, y + 3);
  }
  const pts = labels.map((l, i) => ({
    x: pad.l + (cw/(labels.length-1))*i,
    y: pad.t + ch - (data[i]/max)*ch
  }));
  // Fill
  const grad = ctx.createLinearGradient(0, pad.t, 0, pad.t + ch);
  grad.addColorStop(0, color + '33');
  grad.addColorStop(1, color + '05');
  ctx.beginPath();
  ctx.moveTo(pts[0].x, pad.t + ch);
  pts.forEach(p => ctx.lineTo(p.x, p.y));
  ctx.lineTo(pts[pts.length-1].x, pad.t + ch);
  ctx.closePath(); ctx.fillStyle = grad; ctx.fill();
  // Line
  ctx.beginPath(); ctx.strokeStyle = color; ctx.lineWidth = 2.5;
  pts.forEach((p, i) => i === 0 ? ctx.moveTo(p.x, p.y) : ctx.lineTo(p.x, p.y));
  ctx.stroke();
  // Dots
  pts.forEach(p => {
    ctx.beginPath(); ctx.arc(p.x, p.y, 4, 0, Math.PI*2);
    ctx.fillStyle = '#fff'; ctx.fill();
    ctx.strokeStyle = color; ctx.lineWidth = 2; ctx.stroke();
  });
  // Labels
  labels.forEach((l, i) => {
    ctx.fillStyle = '#888'; ctx.font = '10px system-ui'; ctx.textAlign = 'center';
    ctx.fillText(l, pts[i].x, h - pad.b + 14);
  });
}

function fmtShort(n) {
  if (n >= 1000000) return (n/1000000).toFixed(1) + '–ú';
  if (n >= 1000) return (n/1000).toFixed(0) + '–ö';
  return Math.round(n).toString();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// MODALS & TOAST
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function openModal(id) { document.getElementById(id).classList.add('open'); }
function closeModal(id) { document.getElementById(id).classList.remove('open'); }
document.querySelectorAll('.mo').forEach(m => m.addEventListener('click', e => { if (e.target === m) m.classList.remove('open'); }));

let toastTimer;
// Stat card click bindings ‚Äî multiple methods for maximum reliability
function bindStatCards() {
  ['users','bloggers','issuers','escrow'].forEach(function(type) {
    const btn = document.getElementById('statBtn-' + type);
    if (btn) {
      btn.onclick = function(e) { e.stopPropagation(); openAdminStat(type); };
      btn.addEventListener('click', function(e) { e.stopPropagation(); openAdminStat(type); });
    }
  });
}
// Bind on both events to guarantee firing
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', bindStatCards);
} else {
  bindStatCards();
}
window.addEventListener('load', bindStatCards);

function showToast(msg, err) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.style.background = err ? '#dc2626' : '#1a1a2e';
  t.style.transform = 'translateY(0)'; t.style.opacity = '1';
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => { t.style.transform = 'translateY(80px)'; t.style.opacity = '0'; }, 3500);
}
</script>
</body>
</html>
